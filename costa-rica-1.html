<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Costa Rica | Osa Conservation: Tracker Checker</title>
  <meta name="description" content="3.1 Costa Rica | Osa Conservation: Tracker Checker" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Costa Rica | Osa Conservation: Tracker Checker" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Costa Rica | Osa Conservation: Tracker Checker" />
  
  
  

<meta name="author" content="Chris Beirne" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cluster-detection.html"/>
<link rel="next" href="hardware-function-and-settings.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script src="libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Osa Conservation: Tracker Checker</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Tracker status checker</a></li>
<li class="chapter" data-level="2" data-path="last-48-hours.html"><a href="last-48-hours.html"><i class="fa fa-check"></i><b>2</b> Last 48 Hours</a><ul>
<li class="chapter" data-level="2.0.1" data-path="last-48-hours.html"><a href="last-48-hours.html#costa-rica"><i class="fa fa-check"></i><b>2.0.1</b> Costa Rica</a></li>
<li class="chapter" data-level="2.0.2" data-path="last-48-hours.html"><a href="last-48-hours.html#peru"><i class="fa fa-check"></i><b>2.0.2</b> Peru</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cluster-detection.html"><a href="cluster-detection.html"><i class="fa fa-check"></i><b>3</b> Cluster detection</a><ul>
<li class="chapter" data-level="3.1" data-path="costa-rica-1.html"><a href="costa-rica-1.html"><i class="fa fa-check"></i><b>3.1</b> Costa Rica</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hardware-function-and-settings.html"><a href="hardware-function-and-settings.html"><i class="fa fa-check"></i><b>4</b> Hardware function and settings</a><ul>
<li class="chapter" data-level="4.0.1" data-path="hardware-function-and-settings.html"><a href="hardware-function-and-settings.html#battery-status"><i class="fa fa-check"></i><b>4.0.1</b> Battery status</a></li>
<li class="chapter" data-level="4.0.2" data-path="hardware-function-and-settings.html"><a href="hardware-function-and-settings.html#location-accuracy"><i class="fa fa-check"></i><b>4.0.2</b> Location accuracy</a></li>
<li class="chapter" data-level="4.0.3" data-path="hardware-function-and-settings.html"><a href="hardware-function-and-settings.html#reporting-frequencies"><i class="fa fa-check"></i><b>4.0.3</b> Reporting frequencies</a></li>
<li class="chapter" data-level="4.0.4" data-path="hardware-function-and-settings.html"><a href="hardware-function-and-settings.html#temporal-activity"><i class="fa fa-check"></i><b>4.0.4</b> Temporal activity</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/ChrisBeirne/test_report/" target="blank">Osa Conservation: Tracker Checker</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Osa Conservation: Tracker Checker</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="costa-rica-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> Costa Rica<a href="costa-rica-1.html#costa-rica-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="costa-rica-1.html#cb1-1"></a><span class="co"># Code derived from</span></span>
<span id="cb1-2"><a href="costa-rica-1.html#cb1-2"></a><span class="co"># https://github.com/movestore/Daily-Rest-Sites</span></span>
<span id="cb1-3"><a href="costa-rica-1.html#cb1-3"></a><span class="co">#library(&#39;maptools&#39;)</span></span>
<span id="cb1-4"><a href="costa-rica-1.html#cb1-4"></a><span class="co">#library(&#39;ggmap&#39;)</span></span>
<span id="cb1-5"><a href="costa-rica-1.html#cb1-5"></a></span>
<span id="cb1-6"><a href="costa-rica-1.html#cb1-6"></a><span class="co"># Covert timezone</span></span>
<span id="cb1-7"><a href="costa-rica-1.html#cb1-7"></a>mov_dat<span class="op">$</span>timestamp &lt;-<span class="st"> </span><span class="kw">with_tz</span>(<span class="kw">timestamps</span>(mov_dat), <span class="dt">tz=</span><span class="st">&quot;America/Costa_Rica&quot;</span>)</span>
<span id="cb1-8"><a href="costa-rica-1.html#cb1-8"></a><span class="co"># Subset to costa rica</span></span>
<span id="cb1-9"><a href="costa-rica-1.html#cb1-9"></a>sub_dat &lt;-<span class="st"> </span>mov_dat[mov_dat<span class="op">$</span>location_lat<span class="op">&gt;</span><span class="dv">0</span>,]</span>
<span id="cb1-10"><a href="costa-rica-1.html#cb1-10"></a></span>
<span id="cb1-11"><a href="costa-rica-1.html#cb1-11"></a><span class="co"># Just pull last 3 days</span></span>
<span id="cb1-12"><a href="costa-rica-1.html#cb1-12"></a>start_t2 &lt;-<span class="st"> </span>t<span class="op">-</span><span class="kw">as.difftime</span>(<span class="dv">3</span>,<span class="dt">units=</span><span class="st">&#39;days&#39;</span>)</span>
<span id="cb1-13"><a href="costa-rica-1.html#cb1-13"></a>sub_dat &lt;-<span class="st"> </span>sub_dat[sub_dat<span class="op">$</span>timestamp<span class="op">&gt;</span>start_t2,]</span>
<span id="cb1-14"><a href="costa-rica-1.html#cb1-14"></a></span>
<span id="cb1-15"><a href="costa-rica-1.html#cb1-15"></a></span>
<span id="cb1-16"><a href="costa-rica-1.html#cb1-16"></a>sub_dat<span class="op">$</span>speed &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="kw">speed</span>(sub_dat),c, <span class="ot">NA</span> ))</span>
<span id="cb1-17"><a href="costa-rica-1.html#cb1-17"></a>sub_dat_df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(sub_dat)</span>
<span id="cb1-18"><a href="costa-rica-1.html#cb1-18"></a>sub_dat_df &lt;-<span class="st"> </span><span class="kw">left_join</span>(sub_dat_df, animals[, <span class="kw">c</span>(<span class="st">&quot;tag_id&quot;</span>, <span class="st">&quot;animalName&quot;</span>)])</span></code></pre></div>
<pre><code>## Joining with `by = join_by(tag_id)`</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="costa-rica-1.html#cb3-1"></a>sub_dat_df &lt;-<span class="st"> </span>sub_dat_df[<span class="kw">order</span>(sub_dat_df<span class="op">$</span>animalName),]</span>
<span id="cb3-2"><a href="costa-rica-1.html#cb3-2"></a>lfc &lt;-<span class="st"> </span><span class="kw">do.call</span>(st_sfc,</span>
<span id="cb3-3"><a href="costa-rica-1.html#cb3-3"></a>              <span class="kw">lapply</span>(<span class="kw">split</span>(sub_dat_df, sub_dat_df<span class="op">$</span>animalName),</span>
<span id="cb3-4"><a href="costa-rica-1.html#cb3-4"></a>                     <span class="cf">function</span>(d){<span class="kw">st_linestring</span>(<span class="kw">as.matrix</span>(d[,<span class="kw">c</span>(<span class="st">&quot;location_long&quot;</span>, <span class="st">&quot;location_lat&quot;</span>)]))}))</span>
<span id="cb3-5"><a href="costa-rica-1.html#cb3-5"></a>dat_shp &lt;-<span class="st"> </span><span class="kw">st_sf</span>(<span class="kw">data.frame</span>(<span class="dt">animalName=</span><span class="kw">levels</span>(<span class="kw">factor</span>(sub_dat_df[,<span class="st">&quot;animalName&quot;</span>])), <span class="dt">geom=</span>lfc))</span>
<span id="cb3-6"><a href="costa-rica-1.html#cb3-6"></a></span>
<span id="cb3-7"><a href="costa-rica-1.html#cb3-7"></a><span class="co">#plot(st_geometry(dat_shp))</span></span>
<span id="cb3-8"><a href="costa-rica-1.html#cb3-8"></a></span>
<span id="cb3-9"><a href="costa-rica-1.html#cb3-9"></a><span class="co">#</span></span>
<span id="cb3-10"><a href="costa-rica-1.html#cb3-10"></a><span class="co">#plot(dat$location_long[dat$country==&quot;costa_rica&quot;], dat$location_lat[dat$country==&quot;costa_rica&quot;])</span></span>
<span id="cb3-11"><a href="costa-rica-1.html#cb3-11"></a><span class="co">#plot(st_geometry(dat_shp), add=T)</span></span>
<span id="cb3-12"><a href="costa-rica-1.html#cb3-12"></a></span>
<span id="cb3-13"><a href="costa-rica-1.html#cb3-13"></a><span class="co"># add back in the metadata</span></span>
<span id="cb3-14"><a href="costa-rica-1.html#cb3-14"></a>dat_shp  &lt;-<span class="st"> </span><span class="kw">left_join</span>(dat_shp,sp_dat)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(animalName)`</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="costa-rica-1.html#cb5-1"></a><span class="co"># Bring in the colours from earlier</span></span>
<span id="cb5-2"><a href="costa-rica-1.html#cb5-2"></a>cr_cols &lt;-<span class="st"> </span>tmp_cr[, <span class="kw">c</span>(<span class="st">&quot;animalName&quot;</span>, <span class="st">&quot;colours&quot;</span>)]</span>
<span id="cb5-3"><a href="costa-rica-1.html#cb5-3"></a>cr_cols &lt;-<span class="st"> </span>cr_cols[<span class="kw">duplicated</span>(cr_cols)<span class="op">==</span>F,]</span>
<span id="cb5-4"><a href="costa-rica-1.html#cb5-4"></a>dat_shp &lt;-<span class="st"> </span><span class="kw">left_join</span>(dat_shp, cr_cols)</span></code></pre></div>
<pre><code>## Joining with `by = join_by(animalName)`</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="costa-rica-1.html#cb7-1"></a><span class="co"># Make shapefile of the tracks to add later</span></span>
<span id="cb7-2"><a href="costa-rica-1.html#cb7-2"></a></span>
<span id="cb7-3"><a href="costa-rica-1.html#cb7-3"></a><span class="co">#plot(sub_dat_df$ground_speed, sub_dat_df$speed)</span></span>
<span id="cb7-4"><a href="costa-rica-1.html#cb7-4"></a><span class="co">#plot(sub_dat_df$ground_speed, sub_dat_df$height_above_ellipsoid)</span></span>
<span id="cb7-5"><a href="costa-rica-1.html#cb7-5"></a></span>
<span id="cb7-6"><a href="costa-rica-1.html#cb7-6"></a><span class="co">#plot(sub_dat, col=as.numeric(sub_dat$ground_speed&lt;1)+1)</span></span>
<span id="cb7-7"><a href="costa-rica-1.html#cb7-7"></a><span class="co">#plot(sub_dat[sub_dat$ground_speed&lt;1,], add=T)</span></span>
<span id="cb7-8"><a href="costa-rica-1.html#cb7-8"></a></span>
<span id="cb7-9"><a href="costa-rica-1.html#cb7-9"></a></span>
<span id="cb7-10"><a href="costa-rica-1.html#cb7-10"></a></span>
<span id="cb7-11"><a href="costa-rica-1.html#cb7-11"></a><span class="co"># Specifiy the settings</span></span>
<span id="cb7-12"><a href="costa-rica-1.html#cb7-12"></a></span>
<span id="cb7-13"><a href="costa-rica-1.html#cb7-13"></a>data=sub_dat</span>
<span id="cb7-14"><a href="costa-rica-1.html#cb7-14"></a>window=<span class="st">&quot;all&quot;</span></span>
<span id="cb7-15"><a href="costa-rica-1.html#cb7-15"></a>upX=<span class="dv">0</span></span>
<span id="cb7-16"><a href="costa-rica-1.html#cb7-16"></a>downX=<span class="dv">0</span></span>
<span id="cb7-17"><a href="costa-rica-1.html#cb7-17"></a>speedvar=<span class="st">&quot;speed&quot;</span></span>
<span id="cb7-18"><a href="costa-rica-1.html#cb7-18"></a>maxspeed=<span class="fl">0.2</span></span>
<span id="cb7-19"><a href="costa-rica-1.html#cb7-19"></a></span>
<span id="cb7-20"><a href="costa-rica-1.html#cb7-20"></a>duration=<span class="fl">1.2</span></span>
<span id="cb7-21"><a href="costa-rica-1.html#cb7-21"></a>radius=<span class="dv">50</span></span>
<span id="cb7-22"><a href="costa-rica-1.html#cb7-22"></a></span>
<span id="cb7-23"><a href="costa-rica-1.html#cb7-23"></a></span>
<span id="cb7-24"><a href="costa-rica-1.html#cb7-24"></a><span class="co">#rFunction &lt;- function(data, window=&quot;all&quot;, upX=0, downX=0, speedvar=&quot;speed&quot;, maxspeed=NULL, duration=NULL, radius=NULL)</span></span>
<span id="cb7-25"><a href="costa-rica-1.html#cb7-25"></a><span class="co">#{</span></span>
<span id="cb7-26"><a href="costa-rica-1.html#cb7-26"></a>  <span class="kw">Sys.setenv</span>(<span class="dt">tz=</span><span class="st">&quot;America/Costa_Rica&quot;</span>)</span>
<span id="cb7-27"><a href="costa-rica-1.html#cb7-27"></a>  </span>
<span id="cb7-28"><a href="costa-rica-1.html#cb7-28"></a>  <span class="kw">names</span>(data) &lt;-<span class="st"> </span><span class="kw">make.names</span>(<span class="kw">names</span>(data),<span class="dt">allow_=</span><span class="ot">FALSE</span>)</span>
<span id="cb7-29"><a href="costa-rica-1.html#cb7-29"></a>  </span>
<span id="cb7-30"><a href="costa-rica-1.html#cb7-30"></a>  <span class="co"># add species info</span></span>
<span id="cb7-31"><a href="costa-rica-1.html#cb7-31"></a>  data.df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(data)</span>
<span id="cb7-32"><a href="costa-rica-1.html#cb7-32"></a>  <span class="kw">names</span>(data.df) &lt;-<span class="st"> </span><span class="kw">make.names</span>(<span class="kw">names</span>(data.df),<span class="dt">allow_=</span><span class="ot">FALSE</span>)</span>
<span id="cb7-33"><a href="costa-rica-1.html#cb7-33"></a>  <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">names</span>(data.df)<span class="op">==</span><span class="st">&quot;individual.taxon.canonical.name&quot;</span>)) data<span class="op">@</span>data<span class="op">$</span>species &lt;-<span class="st"> </span>data.df<span class="op">$</span>individual.taxon.canonical.name</span>
<span id="cb7-34"><a href="costa-rica-1.html#cb7-34"></a>  <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">names</span>(data.df)<span class="op">==</span><span class="st">&quot;taxon.canonical.name&quot;</span>)) data<span class="op">@</span>data<span class="op">$</span>species &lt;-<span class="st"> </span>data.df<span class="op">$</span>taxon.canonical.name</span>
<span id="cb7-35"><a href="costa-rica-1.html#cb7-35"></a>  </span>
<span id="cb7-36"><a href="costa-rica-1.html#cb7-36"></a>  speedx &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="co">#input move object</span></span>
<span id="cb7-37"><a href="costa-rica-1.html#cb7-37"></a>  {</span>
<span id="cb7-38"><a href="costa-rica-1.html#cb7-38"></a>    N &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb7-39"><a href="costa-rica-1.html#cb7-39"></a>    <span class="kw">distVincentyEllipsoid</span>(<span class="kw">coordinates</span>(x))<span class="op">/</span><span class="kw">as.numeric</span>(<span class="kw">difftime</span>(<span class="kw">timestamps</span>(x)[<span class="op">-</span><span class="dv">1</span>],<span class="kw">timestamps</span>(x)[<span class="op">-</span>N],<span class="dt">units=</span><span class="st">&quot;secs&quot;</span>))</span>
<span id="cb7-40"><a href="costa-rica-1.html#cb7-40"></a>  }</span>
<span id="cb7-41"><a href="costa-rica-1.html#cb7-41"></a></span>
<span id="cb7-42"><a href="costa-rica-1.html#cb7-42"></a>  n.all &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">timestamps</span>(data))</span>
<span id="cb7-43"><a href="costa-rica-1.html#cb7-43"></a>  data &lt;-<span class="st"> </span>data[<span class="op">!</span><span class="kw">duplicated</span>(<span class="kw">paste0</span>(<span class="kw">round_date</span>(<span class="kw">timestamps</span>(data), <span class="st">&quot;5 mins&quot;</span>), <span class="kw">trackId</span>(data))),]</span>
<span id="cb7-44"><a href="costa-rica-1.html#cb7-44"></a>  </span>
<span id="cb7-45"><a href="costa-rica-1.html#cb7-45"></a>    data.split &lt;-<span class="st"> </span>move<span class="op">::</span><span class="kw">split</span>(data)</span>
<span id="cb7-46"><a href="costa-rica-1.html#cb7-46"></a>    data.ground &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">datai =</span> data.split) <span class="op">%do%</span><span class="st"> </span>{</span>
<span id="cb7-47"><a href="costa-rica-1.html#cb7-47"></a>        <span class="cf">if</span> (speedvar<span class="op">==</span><span class="st">&quot;speed&quot;</span>) </span>
<span id="cb7-48"><a href="costa-rica-1.html#cb7-48"></a>        {</span>
<span id="cb7-49"><a href="costa-rica-1.html#cb7-49"></a>          <span class="cf">if</span> (<span class="kw">length</span>(datai)<span class="op">&gt;</span><span class="dv">1</span>) <span class="co">#cannot calculated between-loc speed if only one location, therefore keep</span></span>
<span id="cb7-50"><a href="costa-rica-1.html#cb7-50"></a>          {</span>
<span id="cb7-51"><a href="costa-rica-1.html#cb7-51"></a>            ix &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">speedx</span>(datai)<span class="op">&lt;</span>maxspeed)</span>
<span id="cb7-52"><a href="costa-rica-1.html#cb7-52"></a>            res &lt;-<span class="st"> </span>datai[<span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(ix,ix<span class="op">+</span><span class="dv">1</span>))),]<span class="co">#this uses the speed between positions</span></span>
<span id="cb7-53"><a href="costa-rica-1.html#cb7-53"></a>          } <span class="cf">else</span></span>
<span id="cb7-54"><a href="costa-rica-1.html#cb7-54"></a>          {</span>
<span id="cb7-55"><a href="costa-rica-1.html#cb7-55"></a> <span class="co">#           logger.info(&quot;One of your tracks contains only one location, so between-location speed cannot be calculated. The location is kept in the data set, but might corrupt the results.&quot;)</span></span>
<span id="cb7-56"><a href="costa-rica-1.html#cb7-56"></a>            res &lt;-<span class="st"> </span>datai</span>
<span id="cb7-57"><a href="costa-rica-1.html#cb7-57"></a>          }</span>
<span id="cb7-58"><a href="costa-rica-1.html#cb7-58"></a>        } <span class="cf">else</span> <span class="cf">if</span> (speedvar <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(datai)) </span>
<span id="cb7-59"><a href="costa-rica-1.html#cb7-59"></a>        {</span>
<span id="cb7-60"><a href="costa-rica-1.html#cb7-60"></a>          res &lt;-<span class="st"> </span>datai[datai<span class="op">@</span>data[,speedvar]<span class="op">&lt;</span>maxspeed <span class="op">|</span><span class="st"> </span><span class="kw">is.na</span>(datai<span class="op">@</span>data[,speedvar]),] <span class="co"># this allows also NA speed to be selected</span></span>
<span id="cb7-61"><a href="costa-rica-1.html#cb7-61"></a><span class="co">#          logger.info(&quot;Your speed variable contains NA, these are kept in the data set of rest positions.&quot;)</span></span>
<span id="cb7-62"><a href="costa-rica-1.html#cb7-62"></a>        } <span class="cf">else</span> </span>
<span id="cb7-63"><a href="costa-rica-1.html#cb7-63"></a>        {</span>
<span id="cb7-64"><a href="costa-rica-1.html#cb7-64"></a><span class="co">#          logger.info(&quot;You have not selected a viable speed variable. Therefore the fallback between location speed is calculated.&quot;)</span></span>
<span id="cb7-65"><a href="costa-rica-1.html#cb7-65"></a>          <span class="cf">if</span> (<span class="kw">length</span>(datai)<span class="op">&gt;</span><span class="dv">1</span>)</span>
<span id="cb7-66"><a href="costa-rica-1.html#cb7-66"></a>          {</span>
<span id="cb7-67"><a href="costa-rica-1.html#cb7-67"></a>            ix &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">speedx</span>(datai)<span class="op">&lt;</span>maxspeed)</span>
<span id="cb7-68"><a href="costa-rica-1.html#cb7-68"></a>            res &lt;-<span class="st"> </span>datai[<span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">c</span>(ix,ix<span class="op">+</span><span class="dv">1</span>))),]<span class="co">#this uses the speed between positions</span></span>
<span id="cb7-69"><a href="costa-rica-1.html#cb7-69"></a>          } <span class="cf">else</span></span>
<span id="cb7-70"><a href="costa-rica-1.html#cb7-70"></a>          {</span>
<span id="cb7-71"><a href="costa-rica-1.html#cb7-71"></a><span class="co">#            logger.info(&quot;One of your tracks contains only one location, so between-location speed cannot be calculated. The location is kept in the data set, but might corrupt the results.&quot;)</span></span>
<span id="cb7-72"><a href="costa-rica-1.html#cb7-72"></a>            res &lt;-<span class="st"> </span>datai</span>
<span id="cb7-73"><a href="costa-rica-1.html#cb7-73"></a>          }</span>
<span id="cb7-74"><a href="costa-rica-1.html#cb7-74"></a>        }</span>
<span id="cb7-75"><a href="costa-rica-1.html#cb7-75"></a>        res</span>
<span id="cb7-76"><a href="costa-rica-1.html#cb7-76"></a>    }</span>
<span id="cb7-77"><a href="costa-rica-1.html#cb7-77"></a>    <span class="kw">names</span>(data.ground) &lt;-<span class="st"> </span><span class="kw">names</span>(data.split)</span>
<span id="cb7-78"><a href="costa-rica-1.html#cb7-78"></a>    data.ground &lt;-<span class="st"> </span><span class="kw">moveStack</span>(data.ground[<span class="kw">unlist</span>(<span class="kw">lapply</span>(data.ground, length) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)])</span>
<span id="cb7-79"><a href="costa-rica-1.html#cb7-79"></a></span>
<span id="cb7-80"><a href="costa-rica-1.html#cb7-80"></a>  </span>
<span id="cb7-81"><a href="costa-rica-1.html#cb7-81"></a>    <span class="co"># select night or day positions (use data.ground, call it &quot;night&quot;)</span></span>
<span id="cb7-82"><a href="costa-rica-1.html#cb7-82"></a>    data.ground.split &lt;-<span class="st"> </span>move<span class="op">::</span><span class="kw">split</span>(data.ground)</span>
<span id="cb7-83"><a href="costa-rica-1.html#cb7-83"></a>    data.night &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">data.groundi =</span> data.ground.split) <span class="op">%do%</span><span class="st"> </span>{</span>
<span id="cb7-84"><a href="costa-rica-1.html#cb7-84"></a>      <span class="co">#print(namesIndiv(data.groundi))</span></span>
<span id="cb7-85"><a href="costa-rica-1.html#cb7-85"></a>      sunupx &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">sunriset</span>(<span class="kw">coordinates</span>(data.groundi), <span class="kw">timestamps</span>(data.groundi), <span class="dt">direction=</span><span class="st">&quot;sunrise&quot;</span>, <span class="dt">POSIXct.out=</span><span class="ot">TRUE</span>))<span class="op">$</span>time <span class="op">+</span><span class="st"> </span>upX<span class="op">*</span><span class="dv">60</span></span>
<span id="cb7-86"><a href="costa-rica-1.html#cb7-86"></a>      sundownx &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">sunriset</span>(<span class="kw">coordinates</span>(data.groundi), <span class="kw">timestamps</span>(data.groundi), <span class="dt">direction=</span><span class="st">&quot;sunset&quot;</span>, <span class="dt">POSIXct.out=</span><span class="ot">TRUE</span>))<span class="op">$</span>time <span class="op">+</span><span class="st"> </span>downX<span class="op">*</span><span class="dv">60</span></span>
<span id="cb7-87"><a href="costa-rica-1.html#cb7-87"></a>      data.groundi<span class="op">@</span>data &lt;-<span class="st"> </span><span class="kw">cbind</span>(data.groundi<span class="op">@</span>data,sunupx,sundownx)</span>
<span id="cb7-88"><a href="costa-rica-1.html#cb7-88"></a></span>
<span id="cb7-89"><a href="costa-rica-1.html#cb7-89"></a>            <span class="co"># there are no sunup or sundown during Arctic summer, then only day positions possible &quot;sunupdown&quot;. respectively for Arctic winter</span></span>
<span id="cb7-90"><a href="costa-rica-1.html#cb7-90"></a>      ix &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">is.na</span>(sunupx) <span class="op">|</span><span class="st"> </span><span class="kw">is.na</span>(sundownx))</span>
<span id="cb7-91"><a href="costa-rica-1.html#cb7-91"></a>      </span>
<span id="cb7-92"><a href="costa-rica-1.html#cb7-92"></a>      ix_ArcSum &lt;-<span class="st"> </span>ix[<span class="kw">coordinates</span>(data.groundi)[ix,<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">50</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.groundi[ix,]))<span class="op">$</span>mon <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>)]</span>
<span id="cb7-93"><a href="costa-rica-1.html#cb7-93"></a>      ix_ArcWin &lt;-<span class="st"> </span>ix[<span class="kw">coordinates</span>(data.groundi)[ix,<span class="dv">2</span>]<span class="op">&gt;</span><span class="dv">50</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.groundi[ix,]))<span class="op">$</span>mon <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">11</span>,<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>)]</span>
<span id="cb7-94"><a href="costa-rica-1.html#cb7-94"></a>      ix_AntWin &lt;-<span class="st"> </span>ix[<span class="kw">coordinates</span>(data.groundi)[ix,<span class="dv">2</span>]<span class="op">&lt;</span>(<span class="op">-</span><span class="dv">50</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.groundi[ix,]))<span class="op">$</span>mon <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">8</span>)]</span>
<span id="cb7-95"><a href="costa-rica-1.html#cb7-95"></a>      ix_AntSum &lt;-<span class="st"> </span>ix[<span class="kw">coordinates</span>(data.groundi)[ix,<span class="dv">2</span>]<span class="op">&lt;</span>(<span class="op">-</span><span class="dv">50</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.groundi[ix,]))<span class="op">$</span>mon <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span><span class="op">:</span><span class="dv">11</span>,<span class="dv">0</span><span class="op">:</span><span class="dv">2</span>)]</span>
<span id="cb7-96"><a href="costa-rica-1.html#cb7-96"></a>      </span>
<span id="cb7-97"><a href="costa-rica-1.html#cb7-97"></a>      <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb7-98"><a href="costa-rica-1.html#cb7-98"></a>      {</span>
<span id="cb7-99"><a href="costa-rica-1.html#cb7-99"></a>        data.nighti &lt;-<span class="st"> </span>data.groundi</span>
<span id="cb7-100"><a href="costa-rica-1.html#cb7-100"></a>        year &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>year<span class="op">+</span><span class="dv">1900</span></span>
<span id="cb7-101"><a href="costa-rica-1.html#cb7-101"></a>        yday &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>yday</span>
<span id="cb7-102"><a href="costa-rica-1.html#cb7-102"></a>        data.nighti<span class="op">@</span>data &lt;-<span class="st"> </span><span class="kw">cbind</span>(data.nighti<span class="op">@</span>data,year,yday)</span>
<span id="cb7-103"><a href="costa-rica-1.html#cb7-103"></a>      } <span class="cf">else</span></span>
<span id="cb7-104"><a href="costa-rica-1.html#cb7-104"></a>      {</span>
<span id="cb7-105"><a href="costa-rica-1.html#cb7-105"></a>        <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sundownup&quot;</span>) <span class="co">#night roosts</span></span>
<span id="cb7-106"><a href="costa-rica-1.html#cb7-106"></a>        {</span>
<span id="cb7-107"><a href="costa-rica-1.html#cb7-107"></a>          <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcSum)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-108"><a href="costa-rica-1.html#cb7-108"></a>          {</span>
<span id="cb7-109"><a href="costa-rica-1.html#cb7-109"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions above the Arctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_ArcSum),&quot; northern summer positions without &#39;night&#39; (May-Sep) are taken out for the calculations.&quot;))</span></span>
<span id="cb7-110"><a href="costa-rica-1.html#cb7-110"></a>            data.groundi &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span>ix_ArcSum,]</span>
<span id="cb7-111"><a href="costa-rica-1.html#cb7-111"></a>          }</span>
<span id="cb7-112"><a href="costa-rica-1.html#cb7-112"></a>          <span class="cf">if</span> (<span class="kw">length</span>(ix_AntSum)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-113"><a href="costa-rica-1.html#cb7-113"></a>          {</span>
<span id="cb7-114"><a href="costa-rica-1.html#cb7-114"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions below the Antarctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_AntSum),&quot; southern summer positions without &#39;night&#39; (Nov-Mar) are taken out for the calculations.&quot;))</span></span>
<span id="cb7-115"><a href="costa-rica-1.html#cb7-115"></a>            data.groundi &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span>ix_AntSum,]</span>
<span id="cb7-116"><a href="costa-rica-1.html#cb7-116"></a>          }</span>
<span id="cb7-117"><a href="costa-rica-1.html#cb7-117"></a>          </span>
<span id="cb7-118"><a href="costa-rica-1.html#cb7-118"></a>          <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcWin)<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">length</span>(ix_AntWin)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-119"><a href="costa-rica-1.html#cb7-119"></a>          {</span>
<span id="cb7-120"><a href="costa-rica-1.html#cb7-120"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions above the Arctic circle and below the Antarctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_ArcWin),&quot; northern winter positions without &#39;day&#39; (Nov-Mar) and&quot;, length(ix_AntWin), &quot; southern winter positions without &#39;day&#39; (May-Sep) are kept in the data fully.&quot;))</span></span>
<span id="cb7-121"><a href="costa-rica-1.html#cb7-121"></a>            data.groundi.ND &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span><span class="kw">c</span>(ix_ArcWin,ix_AntWin),]</span>
<span id="cb7-122"><a href="costa-rica-1.html#cb7-122"></a>            ix.ND &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">along=</span>data.groundi)[<span class="op">-</span><span class="kw">c</span>(ix_ArcWin,ix_AntWin)]</span>
<span id="cb7-123"><a href="costa-rica-1.html#cb7-123"></a>            selND &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&lt;=</span>data.groundi.ND<span class="op">$</span>sunupx <span class="op">|</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&gt;=</span>data.groundi.ND<span class="op">$</span>sundownx)</span>
<span id="cb7-124"><a href="costa-rica-1.html#cb7-124"></a>            data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">sort</span>(<span class="kw">c</span>(ix.ND[selND],ix_ArcWin,ix_AntWin)),]</span>
<span id="cb7-125"><a href="costa-rica-1.html#cb7-125"></a>          } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcWin)<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">length</span>(ix_AntWin)<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb7-126"><a href="costa-rica-1.html#cb7-126"></a>          {</span>
<span id="cb7-127"><a href="costa-rica-1.html#cb7-127"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions above the Arctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_ArcWin),&quot; northern winter positions without &#39;day&#39; (Nov-Mar) are kept in the data fully.&quot;))</span></span>
<span id="cb7-128"><a href="costa-rica-1.html#cb7-128"></a>            data.groundi.ND &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span><span class="kw">c</span>(ix_ArcWin),]</span>
<span id="cb7-129"><a href="costa-rica-1.html#cb7-129"></a>            ix.ND &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">along=</span>data.groundi)[<span class="op">-</span><span class="kw">c</span>(ix_ArcWin)]</span>
<span id="cb7-130"><a href="costa-rica-1.html#cb7-130"></a>            selND &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&lt;=</span>data.groundi.ND<span class="op">$</span>sunupx <span class="op">|</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&gt;=</span>data.groundi.ND<span class="op">$</span>sundownx)</span>
<span id="cb7-131"><a href="costa-rica-1.html#cb7-131"></a>            data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">sort</span>(<span class="kw">c</span>(ix.ND[selND],ix_ArcWin)),]</span>
<span id="cb7-132"><a href="costa-rica-1.html#cb7-132"></a>          } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcWin)<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">length</span>(ix_AntWin)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-133"><a href="costa-rica-1.html#cb7-133"></a>          {</span>
<span id="cb7-134"><a href="costa-rica-1.html#cb7-134"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions below the Antarctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_AntWin),&quot; southern winter positions without &#39;day&#39; (May-Sep) are kept in the data fully.&quot;))</span></span>
<span id="cb7-135"><a href="costa-rica-1.html#cb7-135"></a>            data.groundi.ND &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span><span class="kw">c</span>(ix_AntWin),]</span>
<span id="cb7-136"><a href="costa-rica-1.html#cb7-136"></a>            ix.ND &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">along=</span>data.groundi)[<span class="op">-</span><span class="kw">c</span>(ix_AntWin)]</span>
<span id="cb7-137"><a href="costa-rica-1.html#cb7-137"></a>            selND &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&lt;=</span>data.groundi.ND<span class="op">$</span>sunupx <span class="op">|</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&gt;=</span>data.groundi.ND<span class="op">$</span>sundownx)</span>
<span id="cb7-138"><a href="costa-rica-1.html#cb7-138"></a>            data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">sort</span>(<span class="kw">c</span>(ix.ND[selND],ix_AntWin)),]</span>
<span id="cb7-139"><a href="costa-rica-1.html#cb7-139"></a>          } <span class="cf">else</span> data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">timestamps</span>(data.groundi)<span class="op">&lt;=</span>data.groundi<span class="op">$</span>sunupx <span class="op">|</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi)<span class="op">&gt;=</span>data.groundi<span class="op">$</span>sundownx,]</span>
<span id="cb7-140"><a href="costa-rica-1.html#cb7-140"></a>          </span>
<span id="cb7-141"><a href="costa-rica-1.html#cb7-141"></a>          year &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>year<span class="op">+</span><span class="dv">1900</span></span>
<span id="cb7-142"><a href="costa-rica-1.html#cb7-142"></a>          yday &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>yday</span>
<span id="cb7-143"><a href="costa-rica-1.html#cb7-143"></a>          ynight &lt;-<span class="st"> </span>yday</span>
<span id="cb7-144"><a href="costa-rica-1.html#cb7-144"></a>          </span>
<span id="cb7-145"><a href="costa-rica-1.html#cb7-145"></a>          ixx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">is.na</span>(data.nighti<span class="op">$</span>sundownx))</span>
<span id="cb7-146"><a href="costa-rica-1.html#cb7-146"></a>          <span class="cf">if</span> (<span class="kw">length</span>(ixx)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-147"><a href="costa-rica-1.html#cb7-147"></a>          {</span>
<span id="cb7-148"><a href="costa-rica-1.html#cb7-148"></a>            ynight[<span class="kw">timestamps</span>(data.nighti[<span class="op">-</span>ixx])<span class="op">&gt;</span>data.nighti<span class="op">$</span>sundownx[<span class="op">-</span>ixx]] &lt;-<span class="st"> </span>ynight[<span class="kw">timestamps</span>(data.nighti[<span class="op">-</span>ixx])<span class="op">&gt;</span>data.nighti<span class="op">$</span>sundownx[<span class="op">-</span>ixx]]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb7-149"><a href="costa-rica-1.html#cb7-149"></a>            </span>
<span id="cb7-150"><a href="costa-rica-1.html#cb7-150"></a>            <span class="co"># for Arctic/Antarctic nights the night goes from midday to midday, which depends on the location..</span></span>
<span id="cb7-151"><a href="costa-rica-1.html#cb7-151"></a>            midday_ixx &lt;-<span class="st"> </span><span class="kw">solarnoon</span>(<span class="kw">coordinates</span>(data.nighti[ixx]),<span class="kw">timestamps</span>(data.nighti[ixx]),<span class="dt">POSIXct.out=</span><span class="ot">TRUE</span>)<span class="op">$</span>time</span>
<span id="cb7-152"><a href="costa-rica-1.html#cb7-152"></a>            ynight[<span class="kw">timestamps</span>(data.nighti[ixx])<span class="op">&gt;</span>midday_ixx] &lt;-<span class="st"> </span>ynight[<span class="kw">timestamps</span>(data.nighti[ixx])<span class="op">&gt;</span>midday_ixx]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb7-153"><a href="costa-rica-1.html#cb7-153"></a>          } <span class="cf">else</span> ynight[<span class="kw">timestamps</span>(data.nighti)<span class="op">&gt;</span>data.nighti<span class="op">$</span>sundownx] &lt;-<span class="st"> </span>ynight[<span class="kw">timestamps</span>(data.nighti)<span class="op">&gt;</span>data.nighti<span class="op">$</span>sundownx]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb7-154"><a href="costa-rica-1.html#cb7-154"></a>          </span>
<span id="cb7-155"><a href="costa-rica-1.html#cb7-155"></a>          <span class="co"># adapt for New Year&#39;s Eve</span></span>
<span id="cb7-156"><a href="costa-rica-1.html#cb7-156"></a>          year[<span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>mday<span class="op">==</span><span class="dv">31</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>mon<span class="op">==</span><span class="dv">11</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">timestamps</span>(data.nighti)<span class="op">&gt;</span>data.nighti<span class="op">$</span>sundownx] &lt;-<span class="st"> </span>year[<span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>mday<span class="op">==</span><span class="dv">31</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>mon<span class="op">==</span><span class="dv">11</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">timestamps</span>(data.nighti)<span class="op">&gt;</span>data.nighti<span class="op">$</span>sundownx]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb7-157"><a href="costa-rica-1.html#cb7-157"></a>          ynight[<span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>mday<span class="op">==</span><span class="dv">31</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>mon<span class="op">==</span><span class="dv">11</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">timestamps</span>(data.nighti)<span class="op">&gt;</span>data.nighti<span class="op">$</span>sundownx] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb7-158"><a href="costa-rica-1.html#cb7-158"></a>          </span>
<span id="cb7-159"><a href="costa-rica-1.html#cb7-159"></a>          data.nighti<span class="op">@</span>data &lt;-<span class="st"> </span><span class="kw">cbind</span>(data.nighti<span class="op">@</span>data,year,yday,ynight)</span>
<span id="cb7-160"><a href="costa-rica-1.html#cb7-160"></a>        }</span>
<span id="cb7-161"><a href="costa-rica-1.html#cb7-161"></a>        </span>
<span id="cb7-162"><a href="costa-rica-1.html#cb7-162"></a>        <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sunupdown&quot;</span>) <span class="co"># day rests</span></span>
<span id="cb7-163"><a href="costa-rica-1.html#cb7-163"></a>        {</span>
<span id="cb7-164"><a href="costa-rica-1.html#cb7-164"></a>          <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcWin)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-165"><a href="costa-rica-1.html#cb7-165"></a>          {</span>
<span id="cb7-166"><a href="costa-rica-1.html#cb7-166"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions above the Arctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_ArcWin),&quot; northern winter positions without &#39;day&#39; (Nov-Mar) are taken out for the calculations.&quot;))</span></span>
<span id="cb7-167"><a href="costa-rica-1.html#cb7-167"></a>            data.groundi &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span>ix_ArcWin,]</span>
<span id="cb7-168"><a href="costa-rica-1.html#cb7-168"></a>          }</span>
<span id="cb7-169"><a href="costa-rica-1.html#cb7-169"></a>          <span class="cf">if</span> (<span class="kw">length</span>(ix_AntWin)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-170"><a href="costa-rica-1.html#cb7-170"></a>          {</span>
<span id="cb7-171"><a href="costa-rica-1.html#cb7-171"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions below the Antarctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_AntWin),&quot; southern winter positions without &#39;day&#39; (May-Sep) are taken out for the calculations.&quot;))</span></span>
<span id="cb7-172"><a href="costa-rica-1.html#cb7-172"></a>            data.groundi &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span>ix_AntWin,]</span>
<span id="cb7-173"><a href="costa-rica-1.html#cb7-173"></a>          }</span>
<span id="cb7-174"><a href="costa-rica-1.html#cb7-174"></a>          </span>
<span id="cb7-175"><a href="costa-rica-1.html#cb7-175"></a>          <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcSum)<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">length</span>(ix_AntSum)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-176"><a href="costa-rica-1.html#cb7-176"></a>          {</span>
<span id="cb7-177"><a href="costa-rica-1.html#cb7-177"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions above the Arctic circle and below the Antarctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_ArcSum),&quot; northern summer positions without &#39;night&#39; (May-Sep) and&quot;, length(ix_AntSum), &quot; southern summer positions without &#39;night&#39; (Nov-Mar) are kept in the data fully.&quot;))</span></span>
<span id="cb7-178"><a href="costa-rica-1.html#cb7-178"></a>            data.groundi.ND &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span><span class="kw">c</span>(ix_ArcSum,ix_AntSum),]</span>
<span id="cb7-179"><a href="costa-rica-1.html#cb7-179"></a>            ix.ND &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">along=</span>data.groundi)[<span class="op">-</span><span class="kw">c</span>(ix_ArcSum,ix_AntSum)]</span>
<span id="cb7-180"><a href="costa-rica-1.html#cb7-180"></a>            selND &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&gt;=</span>data.groundi.ND<span class="op">$</span>sunupx <span class="op">&amp;</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&lt;=</span>data.groundi.ND<span class="op">$</span>sundownx)</span>
<span id="cb7-181"><a href="costa-rica-1.html#cb7-181"></a>            data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">sort</span>(<span class="kw">c</span>(ix.ND[selND],ix_ArcSum,ix_AntSum)),]</span>
<span id="cb7-182"><a href="costa-rica-1.html#cb7-182"></a>          } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcSum)<span class="op">&gt;</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">length</span>(ix_AntSum)<span class="op">==</span><span class="dv">0</span>)</span>
<span id="cb7-183"><a href="costa-rica-1.html#cb7-183"></a>          {</span>
<span id="cb7-184"><a href="costa-rica-1.html#cb7-184"></a> <span class="co">#           logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions above the Arctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_ArcSum),&quot; northern summer positions without &#39;night&#39; (May-Sep) are kept in the data fully.&quot;))</span></span>
<span id="cb7-185"><a href="costa-rica-1.html#cb7-185"></a>            data.groundi.ND &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span><span class="kw">c</span>(ix_ArcSum),]</span>
<span id="cb7-186"><a href="costa-rica-1.html#cb7-186"></a>            ix.ND &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">along=</span>data.groundi)[<span class="op">-</span><span class="kw">c</span>(ix_ArcSum)]</span>
<span id="cb7-187"><a href="costa-rica-1.html#cb7-187"></a>            selND &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&gt;=</span>data.groundi.ND<span class="op">$</span>sunupx <span class="op">&amp;</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&lt;=</span>data.groundi.ND<span class="op">$</span>sundownx)</span>
<span id="cb7-188"><a href="costa-rica-1.html#cb7-188"></a>            data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">sort</span>(<span class="kw">c</span>(ix.ND[selND],ix_ArcSum)),]</span>
<span id="cb7-189"><a href="costa-rica-1.html#cb7-189"></a>          } <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">length</span>(ix_ArcSum)<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">length</span>(ix_AntSum)<span class="op">&gt;</span><span class="dv">0</span>)</span>
<span id="cb7-190"><a href="costa-rica-1.html#cb7-190"></a>          {</span>
<span id="cb7-191"><a href="costa-rica-1.html#cb7-191"></a><span class="co">#            logger.info(paste0(&quot;The data set of individual &quot;,namesIndiv(data.groundi),&quot; includes positions below the Antarctic circle, so there are no sunup or sundown events during some time of the year. The relevant &quot;,length(ix_AntSum),&quot; southern summer positions without &#39;night&#39; (Nov-Mar) are kept in the data fully.&quot;))</span></span>
<span id="cb7-192"><a href="costa-rica-1.html#cb7-192"></a>            data.groundi.ND &lt;-<span class="st"> </span>data.groundi[<span class="op">-</span><span class="kw">c</span>(ix_AntSum),]</span>
<span id="cb7-193"><a href="costa-rica-1.html#cb7-193"></a>            ix.ND &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">along=</span>data.groundi)[<span class="op">-</span><span class="kw">c</span>(ix_AntSum)]</span>
<span id="cb7-194"><a href="costa-rica-1.html#cb7-194"></a>            selND &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&gt;=</span>data.groundi.ND<span class="op">$</span>sunupx <span class="op">&amp;</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi.ND)<span class="op">&lt;=</span>data.groundi.ND<span class="op">$</span>sundownx)</span>
<span id="cb7-195"><a href="costa-rica-1.html#cb7-195"></a>            data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">sort</span>(<span class="kw">c</span>(ix.ND[selND],ix_AntSum)),]</span>
<span id="cb7-196"><a href="costa-rica-1.html#cb7-196"></a>          } <span class="cf">else</span> data.nighti &lt;-<span class="st"> </span>data.groundi[<span class="kw">timestamps</span>(data.groundi)<span class="op">&gt;=</span>data.groundi<span class="op">$</span>sunupx <span class="op">&amp;</span><span class="st"> </span><span class="kw">timestamps</span>(data.groundi)<span class="op">&lt;=</span>data.groundi<span class="op">$</span>sundownx,]</span>
<span id="cb7-197"><a href="costa-rica-1.html#cb7-197"></a>          </span>
<span id="cb7-198"><a href="costa-rica-1.html#cb7-198"></a>          year &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>year<span class="op">+</span><span class="dv">1900</span></span>
<span id="cb7-199"><a href="costa-rica-1.html#cb7-199"></a>          yday &lt;-<span class="st"> </span><span class="kw">as.POSIXlt</span>(<span class="kw">timestamps</span>(data.nighti))<span class="op">$</span>yday</span>
<span id="cb7-200"><a href="costa-rica-1.html#cb7-200"></a>          data.nighti<span class="op">@</span>data &lt;-<span class="st"> </span><span class="kw">cbind</span>(data.nighti<span class="op">@</span>data,year,yday)</span>
<span id="cb7-201"><a href="costa-rica-1.html#cb7-201"></a>        }</span>
<span id="cb7-202"><a href="costa-rica-1.html#cb7-202"></a>      }</span>
<span id="cb7-203"><a href="costa-rica-1.html#cb7-203"></a>      <span class="kw">return</span>(data.nighti)</span>
<span id="cb7-204"><a href="costa-rica-1.html#cb7-204"></a>    }</span>
<span id="cb7-205"><a href="costa-rica-1.html#cb7-205"></a>    <span class="cf">if</span> (<span class="kw">is</span>(data.night,<span class="st">&#39;Move&#39;</span>)) data.night &lt;-<span class="st"> </span><span class="kw">moveStack</span>(data.night,<span class="dt">forceTz=</span><span class="st">&quot;UTC&quot;</span>) <span class="co">#force to movestack</span></span>
<span id="cb7-206"><a href="costa-rica-1.html#cb7-206"></a>    <span class="kw">names</span> (data.night) &lt;-<span class="st"> </span><span class="kw">names</span>(data.ground.split)</span>
<span id="cb7-207"><a href="costa-rica-1.html#cb7-207"></a>    data.night.nozero &lt;-<span class="st"> </span>data.night[<span class="kw">unlist</span>(<span class="kw">lapply</span>(data.night, length) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)]</span>
<span id="cb7-208"><a href="costa-rica-1.html#cb7-208"></a>    </span>
<span id="cb7-209"><a href="costa-rica-1.html#cb7-209"></a>    <span class="cf">if</span> (<span class="kw">length</span>(data.night.nozero)<span class="op">==</span><span class="dv">0</span>) <span class="co">#number of list elements</span></span>
<span id="cb7-210"><a href="costa-rica-1.html#cb7-210"></a>    {</span>
<span id="cb7-211"><a href="costa-rica-1.html#cb7-211"></a><span class="co">#      logger.info(&quot;Your data contain no night/day positions. No csv overview saved. Return NULL.&quot;)</span></span>
<span id="cb7-212"><a href="costa-rica-1.html#cb7-212"></a>      result &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb7-213"><a href="costa-rica-1.html#cb7-213"></a>    } <span class="cf">else</span> </span>
<span id="cb7-214"><a href="costa-rica-1.html#cb7-214"></a>    {</span>
<span id="cb7-215"><a href="costa-rica-1.html#cb7-215"></a>      data.night &lt;-<span class="st"> </span><span class="kw">moveStack</span>(data.night.nozero)</span>
<span id="cb7-216"><a href="costa-rica-1.html#cb7-216"></a>      data.night.df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(data.night)</span>
<span id="cb7-217"><a href="costa-rica-1.html#cb7-217"></a>      nacolx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">apply</span>(data.night.df,<span class="dv">2</span>,<span class="cf">function</span> (x) <span class="kw">all</span>(<span class="kw">is.na</span>(x))))</span>
<span id="cb7-218"><a href="costa-rica-1.html#cb7-218"></a>      <span class="cf">if</span> (<span class="kw">length</span>(nacolx)<span class="op">&gt;</span><span class="dv">0</span>) data.night.df.nna &lt;-<span class="st"> </span>data.night.df[,<span class="op">-</span>nacolx] <span class="cf">else</span> data.night.df.nna &lt;-<span class="st"> </span>data.night.df <span class="co">#remove columns with all NA</span></span>
<span id="cb7-219"><a href="costa-rica-1.html#cb7-219"></a>      </span>
<span id="cb7-220"><a href="costa-rica-1.html#cb7-220"></a>      <span class="co">#write.csv(data.night.df.nna,file = paste0(&quot;data_rest_selectedTime.csv&quot;),row.names=FALSE) #csv artefakt of all ground and night (or day...) positions</span></span>
<span id="cb7-221"><a href="costa-rica-1.html#cb7-221"></a>      <span class="co">#write.csv(data.night.df.nna,file = &quot;data_rest_selectedTime.csv&quot;,row.names=FALSE) #csv artefakt of all ground and night (or day...) positions</span></span>
<span id="cb7-222"><a href="costa-rica-1.html#cb7-222"></a>      </span>
<span id="cb7-223"><a href="costa-rica-1.html#cb7-223"></a>      <span class="co"># save all rest positions if is rest by given definition (radius, duration), goes backwards for last night/day rest</span></span>
<span id="cb7-224"><a href="costa-rica-1.html#cb7-224"></a>      data.night.split &lt;-<span class="st"> </span>move<span class="op">::</span><span class="kw">split</span>(data.night)</span>
<span id="cb7-225"><a href="costa-rica-1.html#cb7-225"></a>      </span>
<span id="cb7-226"><a href="costa-rica-1.html#cb7-226"></a>      <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb7-227"><a href="costa-rica-1.html#cb7-227"></a>      {</span>
<span id="cb7-228"><a href="costa-rica-1.html#cb7-228"></a>        prop.rest.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;local.identifier&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;species&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;year&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;yday&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;timestamp.first&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;timestamp.last&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;rest.mean.long&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.mean.lat&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.nposi&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.duration&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.radius&quot;</span>=<span class="kw">numeric</span>())</span>
<span id="cb7-229"><a href="costa-rica-1.html#cb7-229"></a>      } <span class="cf">else</span></span>
<span id="cb7-230"><a href="costa-rica-1.html#cb7-230"></a>      {</span>
<span id="cb7-231"><a href="costa-rica-1.html#cb7-231"></a>        <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sundownup&quot;</span>) prop.rest.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;local.identifier&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;species&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;year&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;ynight&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;timestamp.first&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;timestamp.last&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;rest.mean.long&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.mean.lat&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.nposi&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.duration&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.radius&quot;</span>=<span class="kw">numeric</span>())</span>
<span id="cb7-232"><a href="costa-rica-1.html#cb7-232"></a>        <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sunupdown&quot;</span>) prop.rest.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;local.identifier&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;species&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;year&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;yday&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;timestamp.first&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;timestamp.last&quot;</span>=<span class="kw">character</span>(),<span class="st">&quot;rest.mean.long&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.mean.lat&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.nposi&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.duration&quot;</span>=<span class="kw">numeric</span>(),<span class="st">&quot;rest.radius&quot;</span>=<span class="kw">numeric</span>())</span>
<span id="cb7-233"><a href="costa-rica-1.html#cb7-233"></a>      }</span>
<span id="cb7-234"><a href="costa-rica-1.html#cb7-234"></a>      </span>
<span id="cb7-235"><a href="costa-rica-1.html#cb7-235"></a>      data.rest &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">data.nighti =</span> data.night.split) <span class="op">%do%</span><span class="st"> </span>{</span>
<span id="cb7-236"><a href="costa-rica-1.html#cb7-236"></a><span class="co">#        logger.info(paste(&quot;Extracting rest sites of&quot;,namesIndiv(data.nighti)))</span></span>
<span id="cb7-237"><a href="costa-rica-1.html#cb7-237"></a>        data.resti.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.data.frame</span>(<span class="kw">moveStack</span>(data.nighti)),<span class="kw">coordinates</span>(data.nighti))[<span class="dv">0</span>,] <span class="co">#empty df to fill, moveStack to keep trackId</span></span>
<span id="cb7-238"><a href="costa-rica-1.html#cb7-238"></a>        Nresti &lt;-<span class="st"> </span><span class="kw">dim</span>(data.resti.df)[<span class="dv">2</span>]</span>
<span id="cb7-239"><a href="costa-rica-1.html#cb7-239"></a>        <span class="kw">names</span>(data.resti.df)[(Nresti<span class="dv">-1</span>)<span class="op">:</span>Nresti] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;location.long&quot;</span>,<span class="st">&quot;location.lat&quot;</span>)</span>
<span id="cb7-240"><a href="costa-rica-1.html#cb7-240"></a>        </span>
<span id="cb7-241"><a href="costa-rica-1.html#cb7-241"></a>        year &lt;-<span class="st"> </span><span class="kw">unique</span>(data.nighti<span class="op">@</span>data<span class="op">$</span>year)</span>
<span id="cb7-242"><a href="costa-rica-1.html#cb7-242"></a>        <span class="cf">for</span> (k <span class="cf">in</span> <span class="kw">seq</span>(<span class="dt">along=</span>year))</span>
<span id="cb7-243"><a href="costa-rica-1.html#cb7-243"></a>        {</span>
<span id="cb7-244"><a href="costa-rica-1.html#cb7-244"></a>          </span>
<span id="cb7-245"><a href="costa-rica-1.html#cb7-245"></a>          data.nightik &lt;-<span class="st"> </span>data.nighti[data.nighti<span class="op">@</span>data<span class="op">$</span>year<span class="op">==</span>year[k],]</span>
<span id="cb7-246"><a href="costa-rica-1.html#cb7-246"></a>          </span>
<span id="cb7-247"><a href="costa-rica-1.html#cb7-247"></a>          <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb7-248"><a href="costa-rica-1.html#cb7-248"></a>          {</span>
<span id="cb7-249"><a href="costa-rica-1.html#cb7-249"></a>            night &lt;-<span class="st"> </span><span class="kw">unique</span>(data.nightik<span class="op">@</span>data<span class="op">$</span>yday)</span>
<span id="cb7-250"><a href="costa-rica-1.html#cb7-250"></a>          } <span class="cf">else</span></span>
<span id="cb7-251"><a href="costa-rica-1.html#cb7-251"></a>          {</span>
<span id="cb7-252"><a href="costa-rica-1.html#cb7-252"></a>            <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sundownup&quot;</span>) night &lt;-<span class="st"> </span><span class="kw">unique</span>(data.nightik<span class="op">@</span>data<span class="op">$</span>ynight)</span>
<span id="cb7-253"><a href="costa-rica-1.html#cb7-253"></a>            <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sunupdown&quot;</span>) night &lt;-<span class="st"> </span><span class="kw">unique</span>(data.nightik<span class="op">@</span>data<span class="op">$</span>yday)</span>
<span id="cb7-254"><a href="costa-rica-1.html#cb7-254"></a>          }</span>
<span id="cb7-255"><a href="costa-rica-1.html#cb7-255"></a>          </span>
<span id="cb7-256"><a href="costa-rica-1.html#cb7-256"></a>          <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq</span>(<span class="dt">along=</span>night))</span>
<span id="cb7-257"><a href="costa-rica-1.html#cb7-257"></a>          {</span>
<span id="cb7-258"><a href="costa-rica-1.html#cb7-258"></a>            </span>
<span id="cb7-259"><a href="costa-rica-1.html#cb7-259"></a>            <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb7-260"><a href="costa-rica-1.html#cb7-260"></a>            {</span>
<span id="cb7-261"><a href="costa-rica-1.html#cb7-261"></a>              data.nightikj &lt;-<span class="st"> </span>data.nightik[data.nightik<span class="op">@</span>data<span class="op">$</span>yday<span class="op">==</span>night[j],]</span>
<span id="cb7-262"><a href="costa-rica-1.html#cb7-262"></a>            } <span class="cf">else</span></span>
<span id="cb7-263"><a href="costa-rica-1.html#cb7-263"></a>            {</span>
<span id="cb7-264"><a href="costa-rica-1.html#cb7-264"></a>              <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sundownup&quot;</span>) data.nightikj &lt;-<span class="st"> </span>data.nightik[data.nightik<span class="op">@</span>data<span class="op">$</span>ynight<span class="op">==</span>night[j],]</span>
<span id="cb7-265"><a href="costa-rica-1.html#cb7-265"></a>              <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sunupdown&quot;</span>) data.nightikj &lt;-<span class="st"> </span>data.nightik[data.nightik<span class="op">@</span>data<span class="op">$</span>yday<span class="op">==</span>night[j],]</span>
<span id="cb7-266"><a href="costa-rica-1.html#cb7-266"></a>            }</span>
<span id="cb7-267"><a href="costa-rica-1.html#cb7-267"></a>            </span>
<span id="cb7-268"><a href="costa-rica-1.html#cb7-268"></a>            last &lt;-<span class="st"> </span>Nikj &lt;-<span class="st"> </span><span class="kw">length</span>(data.nightikj)</span>
<span id="cb7-269"><a href="costa-rica-1.html#cb7-269"></a>            <span class="cf">while</span> (last<span class="op">&gt;</span><span class="dv">1</span>) <span class="co"># as long as first night/day position is not the last</span></span>
<span id="cb7-270"><a href="costa-rica-1.html#cb7-270"></a>            {</span>
<span id="cb7-271"><a href="costa-rica-1.html#cb7-271"></a>              data.nightikj &lt;-<span class="st"> </span>data.nightikj[<span class="dv">1</span><span class="op">:</span>last,]</span>
<span id="cb7-272"><a href="costa-rica-1.html#cb7-272"></a>              backdt &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">difftime</span>(<span class="kw">timestamps</span>(data.nightikj)[last],<span class="kw">timestamps</span>(data.nightikj)[<span class="op">-</span><span class="kw">c</span>(last<span class="op">:</span>Nikj)],<span class="dt">units=</span><span class="st">&quot;hours&quot;</span>))</span>
<span id="cb7-273"><a href="costa-rica-1.html#cb7-273"></a>              <span class="cf">if</span> (<span class="kw">length</span>(backdt)<span class="op">&gt;=</span><span class="dv">1</span>) <span class="co">#changed this to allow for further away position (if in radius assume not moved), allows for worse resolution data</span></span>
<span id="cb7-274"><a href="costa-rica-1.html#cb7-274"></a>              {</span>
<span id="cb7-275"><a href="costa-rica-1.html#cb7-275"></a>                <span class="co"># note that here not yet checked that duration in site complete, later</span></span>
<span id="cb7-276"><a href="costa-rica-1.html#cb7-276"></a>                <span class="cf">if</span> (<span class="kw">any</span>(backdt<span class="op">&lt;=</span>duration)) </span>
<span id="cb7-277"><a href="costa-rica-1.html#cb7-277"></a>                {</span>
<span id="cb7-278"><a href="costa-rica-1.html#cb7-278"></a>                  data.sel &lt;-<span class="st"> </span>data.nightikj[<span class="kw">c</span>(<span class="kw">which</span>(backdt<span class="op">&lt;=</span>duration),last),] </span>
<span id="cb7-279"><a href="costa-rica-1.html#cb7-279"></a>                  data.rem &lt;-<span class="st"> </span>data.nightikj[<span class="op">-</span><span class="kw">c</span>(<span class="kw">which</span>(backdt<span class="op">&lt;=</span>duration),last),]</span>
<span id="cb7-280"><a href="costa-rica-1.html#cb7-280"></a>                } <span class="cf">else</span></span>
<span id="cb7-281"><a href="costa-rica-1.html#cb7-281"></a>                {</span>
<span id="cb7-282"><a href="costa-rica-1.html#cb7-282"></a>                  data.sel &lt;-<span class="st"> </span>data.nightikj[(last<span class="dv">-1</span>)<span class="op">:</span>last,]</span>
<span id="cb7-283"><a href="costa-rica-1.html#cb7-283"></a>                  data.rem &lt;-<span class="st"> </span>data.nightikj[<span class="op">-</span><span class="kw">c</span>((last<span class="dv">-1</span>)<span class="op">:</span>last),]</span>
<span id="cb7-284"><a href="costa-rica-1.html#cb7-284"></a>                }</span>
<span id="cb7-285"><a href="costa-rica-1.html#cb7-285"></a>                m &lt;-<span class="st"> </span><span class="kw">colMeans</span>(<span class="kw">coordinates</span>(data.sel))</span>
<span id="cb7-286"><a href="costa-rica-1.html#cb7-286"></a>                dp0 &lt;-<span class="st"> </span><span class="kw">distVincentyEllipsoid</span>(m,<span class="kw">coordinates</span>(data.sel))</span>
<span id="cb7-287"><a href="costa-rica-1.html#cb7-287"></a>                p0 &lt;-<span class="st"> </span><span class="kw">coordinates</span>(data.sel)[<span class="kw">min</span>(<span class="kw">which</span>(dp0<span class="op">==</span><span class="kw">max</span>(dp0))),]</span>
<span id="cb7-288"><a href="costa-rica-1.html#cb7-288"></a>                dp1 &lt;-<span class="st"> </span><span class="kw">distVincentyEllipsoid</span>(p0,<span class="kw">coordinates</span>(data.sel))</span>
<span id="cb7-289"><a href="costa-rica-1.html#cb7-289"></a>                p1 &lt;-<span class="st"> </span><span class="kw">coordinates</span>(data.sel)[<span class="kw">min</span>(<span class="kw">which</span>(dp1<span class="op">==</span><span class="kw">max</span>(dp1))),]</span>
<span id="cb7-290"><a href="costa-rica-1.html#cb7-290"></a>                maxdist &lt;-<span class="st"> </span><span class="kw">distVincentyEllipsoid</span>(p0,p1)</span>
<span id="cb7-291"><a href="costa-rica-1.html#cb7-291"></a>                </span>
<span id="cb7-292"><a href="costa-rica-1.html#cb7-292"></a>                <span class="cf">if</span> (maxdist<span class="op">&lt;</span>radius)</span>
<span id="cb7-293"><a href="costa-rica-1.html#cb7-293"></a>                {</span>
<span id="cb7-294"><a href="costa-rica-1.html#cb7-294"></a>                  <span class="co">## check if already longer at this rest site</span></span>
<span id="cb7-295"><a href="costa-rica-1.html#cb7-295"></a>                  mid &lt;-<span class="st"> </span><span class="kw">midPoint</span>(p0,p1)</span>
<span id="cb7-296"><a href="costa-rica-1.html#cb7-296"></a>                  data.bef &lt;-<span class="st"> </span>data.rem</span>
<span id="cb7-297"><a href="costa-rica-1.html#cb7-297"></a>                  <span class="cf">if</span> (<span class="kw">length</span>(data.bef)<span class="op">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb7-298"><a href="costa-rica-1.html#cb7-298"></a>                  {</span>
<span id="cb7-299"><a href="costa-rica-1.html#cb7-299"></a>                    dist.bef &lt;-<span class="st"> </span><span class="kw">distVincentyEllipsoid</span>(mid,<span class="kw">coordinates</span>(data.bef))</span>
<span id="cb7-300"><a href="costa-rica-1.html#cb7-300"></a>                    <span class="cf">if</span> (<span class="kw">any</span>(dist.bef<span class="op">&gt;</span>radius))</span>
<span id="cb7-301"><a href="costa-rica-1.html#cb7-301"></a>                    {</span>
<span id="cb7-302"><a href="costa-rica-1.html#cb7-302"></a>                      data.selx &lt;-<span class="st"> </span>data.nightikj[<span class="kw">c</span>(<span class="kw">which</span>(backdt<span class="op">&gt;</span>duration)[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">max</span>(<span class="kw">which</span>(dist.bef<span class="op">&gt;</span>radius)))],<span class="kw">which</span>(backdt<span class="op">&lt;=</span>duration),last),]</span>
<span id="cb7-303"><a href="costa-rica-1.html#cb7-303"></a>                      data.remx &lt;-<span class="st"> </span>data.nightikj[<span class="op">-</span><span class="kw">c</span>(<span class="kw">which</span>(backdt<span class="op">&gt;</span>duration)[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">max</span>(<span class="kw">which</span>(dist.bef<span class="op">&gt;</span>radius)))],<span class="kw">which</span>(backdt<span class="op">&lt;=</span>duration),last),]</span>
<span id="cb7-304"><a href="costa-rica-1.html#cb7-304"></a>                    } <span class="cf">else</span> </span>
<span id="cb7-305"><a href="costa-rica-1.html#cb7-305"></a>                    {</span>
<span id="cb7-306"><a href="costa-rica-1.html#cb7-306"></a>                      data.selx &lt;-<span class="st"> </span>data.nightikj[<span class="kw">c</span>(<span class="kw">which</span>(backdt<span class="op">&gt;</span>duration),<span class="kw">which</span>(backdt<span class="op">&lt;=</span>duration),last),]</span>
<span id="cb7-307"><a href="costa-rica-1.html#cb7-307"></a>                      data.remx &lt;-<span class="st"> </span>data.nightikj[<span class="op">-</span><span class="kw">c</span>(<span class="kw">which</span>(backdt<span class="op">&gt;</span>duration),<span class="kw">which</span>(backdt<span class="op">&lt;=</span>duration),last),]</span>
<span id="cb7-308"><a href="costa-rica-1.html#cb7-308"></a>                    }</span>
<span id="cb7-309"><a href="costa-rica-1.html#cb7-309"></a>                  } <span class="cf">else</span> </span>
<span id="cb7-310"><a href="costa-rica-1.html#cb7-310"></a>                  {</span>
<span id="cb7-311"><a href="costa-rica-1.html#cb7-311"></a>                    data.selx &lt;-<span class="st"> </span>data.sel</span>
<span id="cb7-312"><a href="costa-rica-1.html#cb7-312"></a>                    data.remx &lt;-<span class="st"> </span>data.rem</span>
<span id="cb7-313"><a href="costa-rica-1.html#cb7-313"></a>                  }</span>
<span id="cb7-314"><a href="costa-rica-1.html#cb7-314"></a>                  </span>
<span id="cb7-315"><a href="costa-rica-1.html#cb7-315"></a>                  data.selx.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.data.frame</span>(<span class="kw">moveStack</span>(data.selx)),<span class="kw">coordinates</span>(data.selx))</span>
<span id="cb7-316"><a href="costa-rica-1.html#cb7-316"></a>                  Nselx &lt;-<span class="st"> </span><span class="kw">dim</span>(data.selx.df)[<span class="dv">2</span>]</span>
<span id="cb7-317"><a href="costa-rica-1.html#cb7-317"></a>                  <span class="kw">names</span>(data.selx.df)[(Nselx<span class="dv">-1</span>)<span class="op">:</span>Nselx] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;location.long&quot;</span>,<span class="st">&quot;location.lat&quot;</span>)</span>
<span id="cb7-318"><a href="costa-rica-1.html#cb7-318"></a>                  </span>
<span id="cb7-319"><a href="costa-rica-1.html#cb7-319"></a>                  time0 &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">timestamps</span>(data.selx))</span>
<span id="cb7-320"><a href="costa-rica-1.html#cb7-320"></a>                  timeE &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">timestamps</span>(data.selx))</span>
<span id="cb7-321"><a href="costa-rica-1.html#cb7-321"></a>                  durx &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">difftime</span>(timeE,time0,<span class="dt">unit=</span><span class="st">&quot;hour&quot;</span>))</span>
<span id="cb7-322"><a href="costa-rica-1.html#cb7-322"></a>                  radx &lt;-<span class="st"> </span><span class="kw">max</span>(<span class="kw">distVincentyEllipsoid</span>(mid,<span class="kw">coordinates</span>(data.selx)))</span>
<span id="cb7-323"><a href="costa-rica-1.html#cb7-323"></a>                  </span>
<span id="cb7-324"><a href="costa-rica-1.html#cb7-324"></a>                  <span class="cf">if</span> (durx<span class="op">&gt;=</span>duration <span class="op">&amp;</span><span class="st"> </span>radx<span class="op">&lt;=</span>radius) <span class="co">#added this condition to only save rest sites of given duration (if this condition is left out also rest site with shorter duration are given back)</span></span>
<span id="cb7-325"><a href="costa-rica-1.html#cb7-325"></a>                  {</span>
<span id="cb7-326"><a href="costa-rica-1.html#cb7-326"></a>                    data.resti.df &lt;-<span class="st"> </span><span class="kw">rbind</span>(data.resti.df,data.selx.df)</span>
<span id="cb7-327"><a href="costa-rica-1.html#cb7-327"></a>                    </span>
<span id="cb7-328"><a href="costa-rica-1.html#cb7-328"></a>                    <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;all&quot;</span>)</span>
<span id="cb7-329"><a href="costa-rica-1.html#cb7-329"></a>                    {</span>
<span id="cb7-330"><a href="costa-rica-1.html#cb7-330"></a>                      prop.rest.df &lt;-<span class="st"> </span><span class="kw">rbind</span>(prop.rest.df,<span class="kw">data.frame</span>(<span class="st">&quot;local.identifier&quot;</span>=<span class="kw">namesIndiv</span>(data.selx),<span class="st">&quot;species&quot;</span>=data.selx.df<span class="op">$</span>species,<span class="st">&quot;year&quot;</span>=data.selx.df<span class="op">$</span>year[<span class="dv">1</span>],<span class="st">&quot;yday&quot;</span>=data.selx.df<span class="op">$</span>yday[<span class="dv">1</span>],<span class="st">&quot;timestamp.first&quot;</span>=<span class="kw">as.character</span>(time0),<span class="st">&quot;timestamp.last&quot;</span>=<span class="kw">as.character</span>(timeE),<span class="st">&quot;rest.mean.long&quot;</span>=mid[<span class="dv">1</span>,<span class="dv">1</span>],<span class="st">&quot;rest.mean.lat&quot;</span>=mid[<span class="dv">1</span>,<span class="dv">2</span>],<span class="st">&quot;rest.nposi&quot;</span>=<span class="kw">length</span>(data.selx),<span class="st">&quot;rest.duration&quot;</span>=durx,<span class="st">&quot;rest.radius&quot;</span>=radx))</span>
<span id="cb7-331"><a href="costa-rica-1.html#cb7-331"></a>                    } <span class="cf">else</span></span>
<span id="cb7-332"><a href="costa-rica-1.html#cb7-332"></a>                    {</span>
<span id="cb7-333"><a href="costa-rica-1.html#cb7-333"></a>                      <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sundownup&quot;</span>) prop.rest.df &lt;-<span class="st"> </span><span class="kw">rbind</span>(prop.rest.df,<span class="kw">data.frame</span>(<span class="st">&quot;local.identifier&quot;</span>=<span class="kw">namesIndiv</span>(data.selx),<span class="st">&quot;species&quot;</span>=data.selx.df<span class="op">$</span>species[<span class="dv">1</span>],<span class="st">&quot;year&quot;</span>=data.selx.df<span class="op">$</span>year[<span class="dv">1</span>],<span class="st">&quot;ynight&quot;</span>=data.selx.df<span class="op">$</span>ynight[<span class="dv">1</span>],<span class="st">&quot;timestamp.first&quot;</span>=<span class="kw">as.character</span>(time0),<span class="st">&quot;timestamp.last&quot;</span>=<span class="kw">as.character</span>(timeE),<span class="st">&quot;rest.mean.long&quot;</span>=mid[<span class="dv">1</span>,<span class="dv">1</span>],<span class="st">&quot;rest.mean.lat&quot;</span>=mid[<span class="dv">1</span>,<span class="dv">2</span>],<span class="st">&quot;rest.nposi&quot;</span>=<span class="kw">length</span>(data.selx),<span class="st">&quot;rest.duration&quot;</span>=durx,<span class="st">&quot;rest.radius&quot;</span>=radx))</span>
<span id="cb7-334"><a href="costa-rica-1.html#cb7-334"></a>                      <span class="cf">if</span> (window<span class="op">==</span><span class="st">&quot;sunupdown&quot;</span>) prop.rest.df &lt;-<span class="st"> </span><span class="kw">rbind</span>(prop.rest.df,<span class="kw">data.frame</span>(<span class="st">&quot;local.identifier&quot;</span>=<span class="kw">namesIndiv</span>(data.selx),<span class="st">&quot;species&quot;</span>=data.selx.df<span class="op">$</span>species[<span class="dv">1</span>],<span class="st">&quot;year&quot;</span>=data.selx.df<span class="op">$</span>year[<span class="dv">1</span>],<span class="st">&quot;yday&quot;</span>=data.selx.df<span class="op">$</span>yday[<span class="dv">1</span>],<span class="st">&quot;timestamp.first&quot;</span>=<span class="kw">as.character</span>(time0),<span class="st">&quot;timestamp.last&quot;</span>=<span class="kw">as.character</span>(timeE),<span class="st">&quot;rest.mean.long&quot;</span>=mid[<span class="dv">1</span>,<span class="dv">1</span>],<span class="st">&quot;rest.mean.lat&quot;</span>=mid[<span class="dv">1</span>,<span class="dv">2</span>],<span class="st">&quot;rest.nposi&quot;</span>=<span class="kw">length</span>(data.selx),<span class="st">&quot;rest.duration&quot;</span>=durx,<span class="st">&quot;rest.radius&quot;</span>=radx))</span>
<span id="cb7-335"><a href="costa-rica-1.html#cb7-335"></a>                    }</span>
<span id="cb7-336"><a href="costa-rica-1.html#cb7-336"></a>                  }</span>
<span id="cb7-337"><a href="costa-rica-1.html#cb7-337"></a>                  </span>
<span id="cb7-338"><a href="costa-rica-1.html#cb7-338"></a>                  <span class="co">#A) if only need one, i.e. the last, rest site per day/night</span></span>
<span id="cb7-339"><a href="costa-rica-1.html#cb7-339"></a>                  <span class="co">#break </span></span>
<span id="cb7-340"><a href="costa-rica-1.html#cb7-340"></a>                  </span>
<span id="cb7-341"><a href="costa-rica-1.html#cb7-341"></a>                  <span class="co">#B) if need all rest sites (irregardless if previous rest site was saved, check for another one in the remaining data)</span></span>
<span id="cb7-342"><a href="costa-rica-1.html#cb7-342"></a>                  data.nightikj &lt;-<span class="st"> </span>data.remx</span>
<span id="cb7-343"><a href="costa-rica-1.html#cb7-343"></a>                  last &lt;-<span class="st"> </span>Nikj &lt;-<span class="st"> </span><span class="kw">length</span>(data.nightikj) <span class="co">#this can be zero, will be stop indication in while() condition</span></span>
<span id="cb7-344"><a href="costa-rica-1.html#cb7-344"></a>                  </span>
<span id="cb7-345"><a href="costa-rica-1.html#cb7-345"></a>                } <span class="cf">else</span> last &lt;-<span class="st"> </span>last<span class="dv">-1</span> <span class="co">#shift one time step</span></span>
<span id="cb7-346"><a href="costa-rica-1.html#cb7-346"></a>              } <span class="cf">else</span> last &lt;-<span class="st"> </span>last<span class="dv">-1</span> <span class="co"># shift one time step also if not enough data in previous Xh time frame</span></span>
<span id="cb7-347"><a href="costa-rica-1.html#cb7-347"></a>            } <span class="co">#while</span></span>
<span id="cb7-348"><a href="costa-rica-1.html#cb7-348"></a>          } <span class="co">#for j</span></span>
<span id="cb7-349"><a href="costa-rica-1.html#cb7-349"></a>        } <span class="co">#for k</span></span>
<span id="cb7-350"><a href="costa-rica-1.html#cb7-350"></a>        <span class="cf">if</span> (<span class="kw">dim</span>(data.resti.df)[<span class="dv">1</span>]<span class="op">&gt;</span><span class="dv">0</span>) </span>
<span id="cb7-351"><a href="costa-rica-1.html#cb7-351"></a>        {</span>
<span id="cb7-352"><a href="costa-rica-1.html#cb7-352"></a>          o &lt;-<span class="st"> </span><span class="kw">order</span>(data.resti.df<span class="op">$</span>timestamp)</span>
<span id="cb7-353"><a href="costa-rica-1.html#cb7-353"></a>          data.resti &lt;-<span class="st"> </span><span class="kw">move</span>(<span class="dt">x=</span>data.resti.df<span class="op">$</span>location.long[o],<span class="dt">y=</span>data.resti.df<span class="op">$</span>location.lat[o],<span class="dt">time=</span><span class="kw">as.POSIXct</span>(data.resti.df<span class="op">$</span>timestamp[o]),<span class="dt">data=</span>data.resti.df[o,],<span class="dt">sensor=</span>data.resti.df<span class="op">$</span>sensor[o],<span class="dt">animal=</span>data.resti.df<span class="op">$</span>trackId[o])</span>
<span id="cb7-354"><a href="costa-rica-1.html#cb7-354"></a>        } <span class="cf">else</span> data.resti &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb7-355"><a href="costa-rica-1.html#cb7-355"></a>      }</span>
<span id="cb7-356"><a href="costa-rica-1.html#cb7-356"></a>      <span class="kw">names</span>(data.rest) &lt;-<span class="st"> </span><span class="kw">names</span>(data.night.split)</span>
<span id="cb7-357"><a href="costa-rica-1.html#cb7-357"></a>      data.rest.nozero &lt;-<span class="st"> </span>data.rest[<span class="kw">unlist</span>(<span class="kw">lapply</span>(data.rest, length) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)] <span class="co">#remove IDs with no data</span></span>
<span id="cb7-358"><a href="costa-rica-1.html#cb7-358"></a>      </span>
<span id="cb7-359"><a href="costa-rica-1.html#cb7-359"></a>      <span class="cf">if</span> (<span class="kw">length</span>(data.rest.nozero)<span class="op">==</span><span class="dv">0</span>) </span>
<span id="cb7-360"><a href="costa-rica-1.html#cb7-360"></a>      {</span>
<span id="cb7-361"><a href="costa-rica-1.html#cb7-361"></a><span class="co">#        logger.info(&quot;Your output file contains no positions. No csv overview and plot saved. Return NULL.&quot;)</span></span>
<span id="cb7-362"><a href="costa-rica-1.html#cb7-362"></a>        result &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb7-363"><a href="costa-rica-1.html#cb7-363"></a>      } <span class="cf">else</span> </span>
<span id="cb7-364"><a href="costa-rica-1.html#cb7-364"></a>      {</span>
<span id="cb7-365"><a href="costa-rica-1.html#cb7-365"></a>        result &lt;-<span class="st"> </span><span class="kw">moveStack</span>(data.rest.nozero)</span>
<span id="cb7-366"><a href="costa-rica-1.html#cb7-366"></a>        <span class="co">#write.csv(prop.rest.df,file = paste0(&quot;rest_overview.csv&quot;),row.names=FALSE) #csv artefakt</span></span>
<span id="cb7-367"><a href="costa-rica-1.html#cb7-367"></a>        <span class="co">#write.csv(prop.rest.df,file = &quot;rest_overview.csv&quot;,row.names=FALSE)</span></span>
<span id="cb7-368"><a href="costa-rica-1.html#cb7-368"></a>        </span>
<span id="cb7-369"><a href="costa-rica-1.html#cb7-369"></a>        </span>
<span id="cb7-370"><a href="costa-rica-1.html#cb7-370"></a>                <span class="co">#map &lt;- get_map(bbox(extent(data)),source=&quot;stamen&quot;,force=TRUE)</span></span>
<span id="cb7-371"><a href="costa-rica-1.html#cb7-371"></a>        </span>
<span id="cb7-372"><a href="costa-rica-1.html#cb7-372"></a>        <span class="co">#data.df &lt;- data.frame(coordinates(data),as.data.frame(moveStack(data)))</span></span>
<span id="cb7-373"><a href="costa-rica-1.html#cb7-373"></a>        <span class="co">#names(data.df)[1:2] &lt;- c(&quot;location.long0&quot;,&quot;location.lat0&quot;)</span></span>
<span id="cb7-374"><a href="costa-rica-1.html#cb7-374"></a>        </span>
<span id="cb7-375"><a href="costa-rica-1.html#cb7-375"></a>        <span class="co">#out &lt;- ggmap(map) +</span></span>
<span id="cb7-376"><a href="costa-rica-1.html#cb7-376"></a>        <span class="co">#  geom_path(data=data.df,aes(x=location.long0,y=location.lat0,group=trackId),colour=&quot;blue&quot;) +</span></span>
<span id="cb7-377"><a href="costa-rica-1.html#cb7-377"></a>        <span class="co">#  geom_point(data=prop.rest.df,aes(x=rest.mean.long,y=rest.mean.lat),colour=&quot;red&quot;,size=3)</span></span>
<span id="cb7-378"><a href="costa-rica-1.html#cb7-378"></a></span>
<span id="cb7-379"><a href="costa-rica-1.html#cb7-379"></a>                <span class="co">#ggsave(out, file = paste0(&quot;rest_sites_onTracks.pdf&quot;))</span></span>
<span id="cb7-380"><a href="costa-rica-1.html#cb7-380"></a>        </span>
<span id="cb7-381"><a href="costa-rica-1.html#cb7-381"></a>        <span class="co"># note that all timestamps are UTC!</span></span>
<span id="cb7-382"><a href="costa-rica-1.html#cb7-382"></a>      }</span>
<span id="cb7-383"><a href="costa-rica-1.html#cb7-383"></a>    }</span></code></pre></div>
<pre><code>## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded

## Warning in data.frame(local.identifier = namesIndiv(data.selx), species =
## data.selx.df$species, : row names were found from a short variable and have
## been discarded</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="costa-rica-1.html#cb9-1"></a>  <span class="co">#}</span></span>
<span id="cb9-2"><a href="costa-rica-1.html#cb9-2"></a>  <span class="co">#return(result)</span></span>
<span id="cb9-3"><a href="costa-rica-1.html#cb9-3"></a></span>
<span id="cb9-4"><a href="costa-rica-1.html#cb9-4"></a>clus_res &lt;-<span class="st"> </span>prop.rest.df[<span class="kw">duplicated</span>(prop.rest.df)<span class="op">==</span>F,]</span>
<span id="cb9-5"><a href="costa-rica-1.html#cb9-5"></a></span>
<span id="cb9-6"><a href="costa-rica-1.html#cb9-6"></a><span class="co"># Add a colour colum</span></span>
<span id="cb9-7"><a href="costa-rica-1.html#cb9-7"></a>clus_age &lt;-<span class="st"> </span>t<span class="op">-</span><span class="kw">ymd_hms</span>(clus_res<span class="op">$</span>timestamp.last)</span>
<span id="cb9-8"><a href="costa-rica-1.html#cb9-8"></a>clus_res<span class="op">$</span>col &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb9-9"><a href="costa-rica-1.html#cb9-9"></a>clus_res<span class="op">$</span>col[clus_age<span class="op">&lt;</span><span class="dv">24</span>] &lt;-<span class="st"> &quot;red&quot;</span></span>
<span id="cb9-10"><a href="costa-rica-1.html#cb9-10"></a>clus_res<span class="op">$</span>col[clus_age<span class="op">&gt;</span><span class="dv">24</span> <span class="op">&amp;</span><span class="st"> </span>clus_age<span class="op">&lt;</span><span class="dv">48</span>] &lt;-<span class="st"> &quot;orange&quot;</span></span>
<span id="cb9-11"><a href="costa-rica-1.html#cb9-11"></a>clus_res<span class="op">$</span>col[clus_age<span class="op">&gt;</span><span class="dv">48</span>] &lt;-<span class="st"> &quot;blue&quot;</span></span>
<span id="cb9-12"><a href="costa-rica-1.html#cb9-12"></a></span>
<span id="cb9-13"><a href="costa-rica-1.html#cb9-13"></a><span class="co"># # Leaflet the data and add the output</span></span>
<span id="cb9-14"><a href="costa-rica-1.html#cb9-14"></a><span class="co"># cols &lt;- c(&quot;red&quot;, &quot;blue&quot;)</span></span>
<span id="cb9-15"><a href="costa-rica-1.html#cb9-15"></a><span class="co"># </span></span>
<span id="cb9-16"><a href="costa-rica-1.html#cb9-16"></a><span class="co"># m &lt;- leaflet() %&gt;%</span></span>
<span id="cb9-17"><a href="costa-rica-1.html#cb9-17"></a><span class="co">#   # Add a satellite image layer</span></span>
<span id="cb9-18"><a href="costa-rica-1.html#cb9-18"></a><span class="co">#   addProviderTiles(providers$OpenStreetMap.Mapnik) #%&gt;%     </span></span>
<span id="cb9-19"><a href="costa-rica-1.html#cb9-19"></a><span class="co"># </span></span>
<span id="cb9-20"><a href="costa-rica-1.html#cb9-20"></a><span class="co">#  m &lt;- m %&gt;%</span></span>
<span id="cb9-21"><a href="costa-rica-1.html#cb9-21"></a><span class="co">#         addCircleMarkers(lng=sub_dat_df$location_long,</span></span>
<span id="cb9-22"><a href="costa-rica-1.html#cb9-22"></a><span class="co">#                          lat=sub_dat_df$location_lat, </span></span>
<span id="cb9-23"><a href="costa-rica-1.html#cb9-23"></a><span class="co">#                          popup=paste(sub_dat_df$timestamp),</span></span>
<span id="cb9-24"><a href="costa-rica-1.html#cb9-24"></a><span class="co">#                          fillOpacity = 0.3, opacity = 0.5, radius=2, color=cols[as.numeric(sub_dat$ground_speed&lt;1)+1]) </span></span>
<span id="cb9-25"><a href="costa-rica-1.html#cb9-25"></a><span class="co"># </span></span>
<span id="cb9-26"><a href="costa-rica-1.html#cb9-26"></a><span class="co">#  m &lt;- leaflet() %&gt;%</span></span>
<span id="cb9-27"><a href="costa-rica-1.html#cb9-27"></a><span class="co">#   # Add a satellite image layer</span></span>
<span id="cb9-28"><a href="costa-rica-1.html#cb9-28"></a><span class="co">#   addProviderTiles(providers$OpenStreetMap.Mapnik) #%&gt;%     </span></span>
<span id="cb9-29"><a href="costa-rica-1.html#cb9-29"></a><span class="co"># </span></span>
<span id="cb9-30"><a href="costa-rica-1.html#cb9-30"></a><span class="co">#  m &lt;- m %&gt;%</span></span>
<span id="cb9-31"><a href="costa-rica-1.html#cb9-31"></a><span class="co">#         addCircleMarkers(lng=sub_dat_df$location_long,</span></span>
<span id="cb9-32"><a href="costa-rica-1.html#cb9-32"></a><span class="co">#                          lat=sub_dat_df$location_lat, </span></span>
<span id="cb9-33"><a href="costa-rica-1.html#cb9-33"></a><span class="co">#                          popup=paste(sub_dat_df$timestamp),</span></span>
<span id="cb9-34"><a href="costa-rica-1.html#cb9-34"></a><span class="co">#                          fillOpacity = 0.3, opacity = 0.5, radius=2, color=cols[as.numeric(sub_dat_df$speed&lt;0.1)+1]) </span></span>
<span id="cb9-35"><a href="costa-rica-1.html#cb9-35"></a><span class="co"># </span></span>
<span id="cb9-36"><a href="costa-rica-1.html#cb9-36"></a><span class="co"># m </span></span>
<span id="cb9-37"><a href="costa-rica-1.html#cb9-37"></a><span class="co">#  </span></span>
<span id="cb9-38"><a href="costa-rica-1.html#cb9-38"></a><span class="co">#    </span></span>
<span id="cb9-39"><a href="costa-rica-1.html#cb9-39"></a><span class="co">#   m &lt;- m %&gt;%</span></span>
<span id="cb9-40"><a href="costa-rica-1.html#cb9-40"></a><span class="co">#         addCircleMarkers(lng=tmp$rest.mean.long,</span></span>
<span id="cb9-41"><a href="costa-rica-1.html#cb9-41"></a><span class="co">#                          lat=tmp$rest.mean.lat, </span></span>
<span id="cb9-42"><a href="costa-rica-1.html#cb9-42"></a><span class="co">#                          popup=paste(&quot;duration =&quot;,tmp$rest.duration, &quot;npos =&quot;,tmp$rest.nposi),</span></span>
<span id="cb9-43"><a href="costa-rica-1.html#cb9-43"></a><span class="co">#                          fillOpacity = 0.3, opacity = 0.7, radius=4, color=&quot;orange&quot;) </span></span>
<span id="cb9-44"><a href="costa-rica-1.html#cb9-44"></a><span class="co"># </span></span>
<span id="cb9-45"><a href="costa-rica-1.html#cb9-45"></a><span class="co"># m  </span></span>
<span id="cb9-46"><a href="costa-rica-1.html#cb9-46"></a> </span>
<span id="cb9-47"><a href="costa-rica-1.html#cb9-47"></a>m &lt;-<span class="st"> </span><span class="kw">leaflet</span>() <span class="op">%&gt;%</span></span>
<span id="cb9-48"><a href="costa-rica-1.html#cb9-48"></a><span class="st">  </span><span class="co"># Add a satellite image layer  </span></span>
<span id="cb9-49"><a href="costa-rica-1.html#cb9-49"></a><span class="st">  </span><span class="kw">addProviderTiles</span>(providers<span class="op">$</span>Stamen.TonerLite, <span class="dt">group=</span><span class="st">&quot;Simple&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb9-50"><a href="costa-rica-1.html#cb9-50"></a><span class="st">  </span><span class="kw">addProviderTiles</span>(providers<span class="op">$</span>Esri.WorldImagery, <span class="dt">group=</span><span class="st">&quot;Satellite&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb9-51"><a href="costa-rica-1.html#cb9-51"></a><span class="st">  </span><span class="kw">addProviderTiles</span>(providers<span class="op">$</span>OpenStreetMap.Mapnik, <span class="dt">group=</span><span class="st">&quot;OS&quot;</span>) <span class="co">#%&gt;%     </span></span>
<span id="cb9-52"><a href="costa-rica-1.html#cb9-52"></a>  m &lt;-<span class="st"> </span>m <span class="op">%&gt;%</span></span>
<span id="cb9-53"><a href="costa-rica-1.html#cb9-53"></a><span class="st">        </span><span class="kw">addPolylines</span>(<span class="dt">data =</span> dat_shp, <span class="dt">color =</span> dat_shp<span class="op">$</span>colours, <span class="dt">weight=</span><span class="dv">3</span>,<span class="dt">opacity=</span><span class="fl">0.3</span>, <span class="dt">popup=</span>dat_shp<span class="op">$</span>animalName) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-54"><a href="costa-rica-1.html#cb9-54"></a><span class="st">        </span><span class="kw">addCircleMarkers</span>(<span class="dt">lng=</span>clus_res<span class="op">$</span>rest.mean.long,</span>
<span id="cb9-55"><a href="costa-rica-1.html#cb9-55"></a>                         <span class="dt">lat=</span>clus_res<span class="op">$</span>rest.mean.lat, </span>
<span id="cb9-56"><a href="costa-rica-1.html#cb9-56"></a>                         <span class="dt">popup=</span><span class="kw">paste</span>(<span class="st">&quot;name&quot;</span>=clus_res<span class="op">$</span>local.identifier, </span>
<span id="cb9-57"><a href="costa-rica-1.html#cb9-57"></a>                                     <span class="st">&quot;&lt;br&gt;duration =&quot;</span>,<span class="kw">round</span>(clus_res<span class="op">$</span>rest.duration,<span class="dv">1</span>), <span class="st">&quot;h&quot;</span>, </span>
<span id="cb9-58"><a href="costa-rica-1.html#cb9-58"></a>                                     <span class="st">&quot;&lt;br&gt;npos =&quot;</span>,clus_res<span class="op">$</span>rest.nposi, <span class="st">&quot; Radius =&quot;</span> ,<span class="kw">round</span>(clus_res<span class="op">$</span>rest.radius,<span class="dv">1</span>),<span class="st">&quot;m&quot;</span>,</span>
<span id="cb9-59"><a href="costa-rica-1.html#cb9-59"></a>                                     <span class="st">&quot;&lt;br&gt;lon =&quot;</span> ,<span class="kw">round</span>(clus_res<span class="op">$</span>rest.mean.lon,<span class="dv">6</span>)  , <span class="st">&quot;lat =&quot;</span>, <span class="kw">round</span>(clus_res<span class="op">$</span>rest.mean.lat,<span class="dv">6</span>)) </span>
<span id="cb9-60"><a href="costa-rica-1.html#cb9-60"></a>                                     ,</span>
<span id="cb9-61"><a href="costa-rica-1.html#cb9-61"></a>                          <span class="dt">fillOpacity =</span> <span class="fl">0.3</span>, <span class="dt">opacity =</span> <span class="fl">0.7</span>, <span class="dt">radius=</span><span class="dv">4</span>, <span class="dt">color=</span>clus_res<span class="op">$</span>col)<span class="op">%&gt;%</span></span>
<span id="cb9-62"><a href="costa-rica-1.html#cb9-62"></a><span class="st">      </span><span class="kw">addScaleBar</span>(<span class="dt">position=</span><span class="st">&quot;topleft&quot;</span>, </span>
<span id="cb9-63"><a href="costa-rica-1.html#cb9-63"></a>                  <span class="dt">options=</span><span class="kw">scaleBarOptions</span>(<span class="dt">maxWidth =</span> <span class="dv">100</span>, <span class="dt">metric =</span> <span class="ot">TRUE</span>, <span class="dt">imperial =</span> <span class="ot">FALSE</span>, <span class="dt">updateWhenIdle =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb9-64"><a href="costa-rica-1.html#cb9-64"></a><span class="st">      </span><span class="kw">addLayersControl</span>(</span>
<span id="cb9-65"><a href="costa-rica-1.html#cb9-65"></a>        <span class="dt">baseGroups =</span> <span class="kw">c</span>(<span class="st">&quot;OS&quot;</span>, <span class="st">&quot;Simple&quot;</span>, <span class="st">&quot;Satellite&quot;</span>),</span>
<span id="cb9-66"><a href="costa-rica-1.html#cb9-66"></a>        <span class="dt">options =</span> <span class="kw">layersControlOptions</span>(<span class="dt">collapsed =</span> <span class="ot">FALSE</span>)</span>
<span id="cb9-67"><a href="costa-rica-1.html#cb9-67"></a>      )  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-68"><a href="costa-rica-1.html#cb9-68"></a><span class="st">    </span><span class="kw">addLegend</span>(<span class="dt">position=</span><span class="st">&quot;topright&quot;</span>, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;&lt;24&quot;</span>, <span class="st">&quot;24-48&quot;</span>, <span class="st">&quot;48+&quot;</span>), <span class="dt">colors=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="dt">title=</span><span class="st">&quot;Cluster age&quot;</span>)</span>
<span id="cb9-69"><a href="costa-rica-1.html#cb9-69"></a></span>
<span id="cb9-70"><a href="costa-rica-1.html#cb9-70"></a>  m</span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-84485f9deab50540e945" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-84485f9deab50540e945">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["Stamen.TonerLite",null,"Simple",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Satellite",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["OpenStreetMap.Mapnik",null,"OS",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addPolylines","args":[[[[{"lng":[-83.4276616,-83.4276316,-83.4276584,-83.4276697,-83.4276378,-83.4276543,-83.4275853,-83.4276446,-83.4275741,-83.4276918,-83.4278052,-83.4276149,-83.4276593,-83.4279042,-83.4277034,-83.4277326,-83.4277018,-83.4276536,-83.427664,-83.4276608,-83.4276196,-83.4277018,-83.4276082,-83.4277781,-83.4275686,-83.4276436,-83.4277137,-83.4277257,-83.4277536,-83.4278514,-83.4277955,-83.4278187,-83.4278048,-83.4278312,-83.4278296,-83.4278582,-83.4278458,-83.4278223,-83.4278262,-83.4278111,-83.4277803,-83.4276568,-83.4277064,-83.42794,-83.4275077,-83.4276821,-83.4278512,-83.4275597,-83.4276102,-83.4276494,-83.4278668,-83.4277934,-83.4277632,-83.4277285,-83.4278241,-83.4277501,-83.4276877,-83.4276567,-83.427576,-83.4275744,-83.4275891,-83.4275851,-83.4286064,-83.428471,-83.4286348,-83.4285912,-83.4286003,-83.4285547,-83.4282303,-83.4372398,-83.4470854,-83.4557948,-83.4355563,-83.4327293,-83.43266,-83.4332696,-83.4332736,-83.4331721,-83.4331437,-83.433145,-83.4330334,-83.4328717,-83.432956,-83.4329214,-83.4330198,-83.4330362,-83.4329296,-83.4331662,-83.4345343,-83.4329881,-83.4332065,-83.4335359,-83.4331551,-83.4327422,-83.4330703,-83.4329513,-83.4329116,-83.4329657,-83.433013,-83.4329997,-83.432999,-83.4329585,-83.4329984,-83.432988,-83.4330129,-83.4330727,-83.4329933,-83.4329642,-83.4329694,-83.4330139,-83.4330542,-83.4332756,-83.4332357,-83.4330635,-83.4332456,-83.4333559,-83.4334276,-83.4333994,-83.4333125,-83.4333576,-83.4334092,-83.4333613,-83.4334042,-83.4331815,-83.4331324,-83.4334593,-83.433369,-83.4333579,-83.433412,-83.433109,-83.4333229,-83.4333015,-83.4333185,-83.4333045,-83.4332284,-83.4332735,-83.4333041,-83.4332564,-83.4333076,-83.4332906,-83.4331434,-83.4329375,-83.4329832,-83.4330324,-83.4330059,-83.433003,-83.4330413,-83.4330436,-83.4329838,-83.4329779,-83.4329206,-83.4330246,-83.4330011,-83.4330504,-83.4330478,-83.4329396,-83.4330404,-83.4330049,-83.4329579,-83.4330969,-83.4330981,-83.432936,-83.4330043,-83.4330825,-83.4330594,-83.433009,-83.4330874,-83.4330993,-83.4331546,-83.4330768,-83.4329617,-83.4329666,-83.4330133,-83.4331195,-83.43327,-83.433295,-83.4333625,-83.4335142,-83.4333565,-83.4333836,-83.4334244,-83.4335098,-83.4334352,-83.4334742,-83.4334117,-83.4332556,-83.4334355,-83.4333664,-83.4334019,-83.4333864,-83.4333895,-83.4333664,-83.4333953,-83.4334387,-83.4334089,-83.4333704,-83.4333029,-83.4334423,-83.4332718,-83.4333215,-83.4332441,-83.4332787,-83.4332776,-83.4333333,-83.4332791,-83.4332556,-83.4333268,-83.4331972,-83.433222,-83.4333017,-83.4331342,-83.433342,-83.4331405,-83.4334715,-83.4332527,-83.4334742,-83.4333713,-83.4332905,-83.4333156,-83.4333291,-83.4333088,-83.4333416,-83.4333315,-83.4333578],"lat":[8.5897911,8.5898177,8.5898746,8.5898268,8.5897944,8.5898638,8.5897941,8.5897359,8.5898055,8.5898302,8.5898036,8.5897579,8.5898402,8.5886287,8.5886522,8.5887826,8.588689,8.588818,8.588689,8.5886779,8.5888098,8.5886056,8.5886642,8.5885469,8.5887681,8.5886616,8.5885622,8.5885211,8.5885324,8.5895486,8.5898055,8.5898422,8.5899055,8.5898305,8.5899056,8.5898015,8.5899089,8.5898711,8.5898632,8.5898822,8.5898899,8.5898209,8.5898537,8.5898406,8.5896742,8.5897577,8.5899756,8.5897924,8.5897682,8.5898084,8.589826,8.58984,8.5898296,8.5898865,8.5898323,8.5899124,8.5899,8.5898332,8.589822,8.5897743,8.5898086,8.5897722,8.5901101,8.5901515,8.5901326,8.5901571,8.5912034,8.5912231,8.5906666,8.5956556,8.6185943,8.6203669,8.621349,8.6240027,8.6233767,8.6234668,8.6234734,8.6235007,8.6234813,8.623519,8.6233943,8.6229645,8.6230303,8.6229932,8.6230689,8.6229543,8.6231726,8.6230492,8.6231515,8.6229389,8.6230455,8.6227584,8.6229579,8.6230022,8.6229146,8.6230259,8.622977,8.6230371,8.6230004,8.6230409,8.6230057,8.6230389,8.6229943,8.6229877,8.6230033,8.6228642,8.6228707,8.6229217,8.6228573,8.6228591,8.6229645,8.6234495,8.6234433,8.6235157,8.6234204,8.6233251,8.62324,8.6232524,8.6233109,8.6232972,8.6233024,8.6232802,8.6231818,8.6231029,8.6231637,8.6235836,8.6235242,8.62353,8.6235638,8.6235546,8.6235327,8.6235731,8.6235311,8.6234294,8.6234539,8.6234643,8.623473,8.6234709,8.6234765,8.6234715,8.6232527,8.6227324,8.6227238,8.6226827,8.6227495,8.6227114,8.622697,8.6227308,8.6228252,8.6226305,8.6227013,8.6226887,8.6226843,8.6228279,8.6226981,8.6227466,8.6227319,8.6227606,8.6227328,8.6227674,8.6226674,8.6226676,8.6227112,8.6226649,8.6226743,8.6226106,8.6226548,8.6227347,8.6226507,8.6226748,8.622719,8.6226686,8.6227726,8.6227059,8.6234973,8.6234709,8.6234531,8.6234835,8.6234176,8.6234462,8.6234414,8.6234059,8.6234407,8.6234639,8.6234645,8.6232854,8.6233389,8.6234491,8.6234241,8.623457,8.6234864,8.6234236,8.6234331,8.6234354,8.6233717,8.6234075,8.6231415,8.6234137,8.6233658,8.6234438,8.6234615,8.6234473,8.623471,8.6234469,8.6234674,8.6233881,8.6235009,8.6235185,8.6234966,8.6233938,8.6232693,8.6234834,8.6235425,8.6234771,8.623522,8.6233776,8.6233777,8.6233386,8.6233246,8.6233651,8.623339,8.6233537,8.6233538,8.6233279]}]],[[{"lng":[-83.1262226,-83.1207379,-83.1374597,-83.1427725,-83.1426695,-83.1427144,-83.1427114,-83.1266619,-83.126551,-83.1264321,-83.1267808,-83.1347771,-83.1399827,-83.1325383,-83.142082,-83.1663817,-83.1787881,-83.2245943,-83.2345008,-83.2344997,-83.2323334,-83.2331469,-83.2321596,-83.2321532,-83.2354639,-83.2350258,-83.2381875,-83.2365983,-83.2355049,-83.2357668,-83.2358149,-83.2364408,-83.2363115,-83.236316,-83.3103516,-83.3114465,-83.350384,-83.3748995,-83.4425255,-83.457707,-83.4608767,-83.4327545,-83.4332434,-83.4333151,-83.5000403,-83.4719622,-83.4873706,-83.433108,-83.4329546,-83.4331445,-83.4330583,-83.4334025,-83.4332023,-83.4332228,-83.4332272,-83.4330779,-83.4337007,-83.434029,-83.4348029,-83.4342289,-83.4341472,-83.4331401,-83.4331524,-83.4332541,-83.4330956,-83.4342106,-83.4346225,-83.4345778,-83.4346242],"lat":[8.8701785,8.9090107,8.919642,8.9181333,8.9182057,8.9182058,8.9183706,8.9177916,8.9173912,8.9176667,8.9176827,8.9299056,8.9268869,8.9292067,8.9158494,8.9216845,8.8927143,8.8491321,8.8320632,8.843312,8.8455943,8.8460426,8.8455353,8.845473,8.8413437,8.8413381,8.8363321,8.8465368,8.8470751,8.8467465,8.8468675,8.8457039,8.8457634,8.8456632,8.7583507,8.7595761,8.8006521,8.7813746,8.7616438,8.7727035,8.7736177,8.7530239,8.7524456,8.7525681,8.7269463,8.7473926,8.7321543,8.7531056,8.7530759,8.752485,8.7524099,8.7527365,8.7524089,8.7523877,8.7524344,8.7524313,8.7528391,8.7527017,8.7516089,8.7520522,8.7514094,8.7525681,8.7525866,8.7513326,8.7528595,8.7520262,8.7514178,8.7512619,8.7511158]}]],[[{"lng":[-83.8605632,-83.8604948,-83.8606714,-83.8604765,-83.8605697,-83.8572177,-83.8569995,-83.8572066,-83.8569651,-83.8569974,-83.8570143,-83.8599925,-83.8599943,-83.8605758,-83.8604829,-83.8605188,-83.8604754,-83.8600781,-83.8604762,-83.8605468,-83.860482,-83.8604645,-83.8604128,-83.8604646,-83.8603159,-83.8603843,-83.8602491,-83.8604468,-83.8605404,-83.8582349,-83.8976494,-83.8976729,-83.8975994,-83.8980179,-83.8982309,-83.8980657,-83.8981376,-83.8982121,-83.8947083,-83.8948946,-83.8945954,-83.8947906,-83.8950352,-83.8947338,-83.8947506,-83.8952333,-83.8950591,-83.8949768,-83.8949769,-83.8949177,-83.8947956,-83.8942408,-83.8928926,-83.893208,-83.8930844,-83.8930077,-83.8932721,-83.8927717,-83.8980852,-83.8980932],"lat":[9.3692205,9.3689383,9.3690196,9.3690353,9.3689863,9.3663553,9.3667867,9.3669695,9.3670704,9.3667236,9.3667857,9.3675782,9.3675386,9.369036,9.3689045,9.3689893,9.369066,9.368917,9.3691015,9.3690712,9.3691788,9.3690419,9.3690178,9.3691092,9.3688587,9.3689129,9.368724,9.3689206,9.3689386,9.3640397,9.3862001,9.3862376,9.3862547,9.3855215,9.3854626,9.3854244,9.38541,9.3854202,9.3811763,9.3815585,9.3814829,9.3814018,9.3817384,9.3815112,9.3811762,9.3805569,9.381361,9.3813701,9.3813812,9.3813167,9.3813315,9.3810302,9.3782842,9.3782676,9.3782823,9.3783193,9.3782875,9.3773575,9.3828882,9.3828606]}]],[[{"lng":[-83.318281,-83.3114004,-83.3156428,-83.3176219,-83.3245173,-83.3177714,-83.3182976,-83.317864,-83.317897,-83.3178843,-83.3179022,-83.3185188,-83.3184128,-83.3186196,-83.3183022,-83.3184255,-83.3270367,-83.323251,-83.3190864,-83.3259144,-83.318584,-83.3224688,-83.3144537,-83.3139306,-83.3177527,-83.3090139,-83.3261171,-83.3196054,-83.3181034,-83.3241042,-83.3304029,-83.3377212,-83.3151134,-83.3238181,-83.3224753,-83.2992548,-83.2975007,-83.2974144,-83.2946189,-83.3051253,-83.3201903,-83.3164161,-83.3191057,-83.3172724,-83.3151674,-83.3169612,-83.3144094,-83.3144457,-83.3152275,-83.3151766,-83.3181666,-83.3123479,-83.3159462,-83.3108803,-83.3108257,-83.3107813,-83.3109884,-83.3110556,-83.3111615,-83.3112588,-83.3111755,-83.3111145,-83.3174445,-83.3212449,-83.3224173,-83.321411,-83.3239732,-83.3195831,-83.3241103,-83.3223657,-83.3262637,-83.3204936,-83.3185091,-83.3190491,-83.3184844,-83.3188396,-83.3189936,-83.3190485,-83.3190728,-83.3240019,-83.3239637,-83.3236707,-83.3238858,-83.3236154,-83.323815,-83.3237136,-83.3237821,-83.3231622,-83.3236215,-83.3235491,-83.3239207],"lat":[8.4090845,8.4041082,8.4111112,8.4114565,8.4130496,8.4160553,8.421478,8.4162936,8.4163085,8.4163239,8.4162933,8.4167634,8.4167477,8.4164361,8.4165324,8.4164933,8.4058732,8.4071427,8.4069397,8.4125057,8.4200288,8.4180136,8.4147474,8.413903,8.4155892,8.416771,8.4199613,8.4019077,8.4108423,8.4050182,8.4075462,8.4078145,8.4149751,8.4144572,8.402153,8.4246078,8.4264714,8.4263301,8.4349356,8.4087187,8.4100839,8.4120875,8.4057036,8.4077336,8.404004,8.39972,8.4031947,8.4032328,8.4024184,8.4023861,8.397652,8.3996426,8.4150562,8.4081171,8.4080981,8.4081191,8.4081434,8.4081001,8.4080137,8.4081654,8.4080593,8.4080582,8.4041692,8.4091297,8.4100975,8.4214091,8.4153464,8.4066449,8.4017393,8.4134412,8.4213487,8.4010394,8.3877276,8.3877598,8.3879291,8.3876458,8.3872173,8.387194,8.3872198,8.3908585,8.3908593,8.3905291,8.3907635,8.3908453,8.3907876,8.3909014,8.3908558,8.391038,8.3909664,8.3907928,8.3909467]}]],[[{"lng":[-83.3059611,-83.3059609,-83.306012,-83.3059701,-83.3111529,-83.3085157,-83.3131952,-83.3118256,-83.3078714,-83.3116267,-83.308223,-83.3082129,-83.3082044,-83.3081551,-83.3081566,-83.3081852,-83.3081785,-83.3081286,-83.3081902,-83.3081601,-83.308188,-83.3081673,-83.308212,-83.3080418,-83.3081153,-83.3083163,-83.3082507,-83.3085519,-83.3082907,-83.3081646,-83.3082395,-83.3082327,-83.3081972,-83.3082164,-83.3082303,-83.3090083,-83.3090104,-83.3088976,-83.3081822,-83.3081738,-83.308223,-83.2931929,-83.2979748,-83.2977145,-83.3047914,-83.2881043,-83.2888283,-83.28878,-83.2888146,-83.2887827,-83.2877855,-83.2936819,-83.29523,-83.2995667,-83.3011696,-83.299385,-83.2951546,-83.300835,-83.2993084,-83.2989836,-83.301011,-83.290748,-83.3076864,-83.300678,-83.3077947,-83.3077929,-83.3078738,-83.3077982,-83.3077755,-83.3078401,-83.3100715,-83.3019617,-83.2939087,-83.3040385,-83.3015608,-83.3136355,-83.3014215,-83.3050521,-83.3107892,-83.3047302,-83.3061016,-83.3095013,-83.3120108,-83.3020521,-83.3115139,-83.3075156,-83.3147561,-83.3111266,-83.3111046,-83.3111696,-83.3111836,-83.3112054,-83.3111903,-83.3111746,-83.3112055,-83.3111806,-83.3111989,-83.3111778,-83.3111621,-83.3111601,-83.3111419,-83.3111201,-83.3110957,-83.3111126,-83.3111099,-83.3111307,-83.31111,-83.3155977,-83.3155785,-83.3176705,-83.317787,-83.3175682,-83.3178056,-83.3177041,-83.3176389,-83.3177285,-83.3176737,-83.3176898,-83.3178501,-83.3176958,-83.3177609,-83.3177869,-83.3177713,-83.3177736,-83.3173981,-83.318715,-83.3176917,-83.3176841,-83.3176587,-83.3177367,-83.3177849,-83.3176496,-83.3175394,-83.3176222,-83.3175852,-83.3160978,-83.3161921,-83.3158174,-83.3069221,-83.2945514,-83.2939389,-83.3076941,-83.3077931,-83.3078111,-83.3093555,-83.3012549,-83.2982928,-83.2885366,-83.2877349,-83.2931015,-83.2889499,-83.307133,-83.3057302,-83.294661,-83.30469,-83.2966478,-83.3054726,-83.2986264,-83.3051272,-83.3104037,-83.3124805,-83.3097625,-83.3078565,-83.3089373,-83.3066122,-83.2929332,-83.2920123,-83.3009622,-83.3195614,-83.3143825,-83.3076219,-83.3119031,-83.3043749,-83.3329382,-83.3504176,-83.3223219,-83.3055439,-83.2932956,-83.2933092,-83.2932955,-83.2932596,-83.2932779,-83.2951981,-83.3071558,-83.3074106,-83.307567,-83.3001764,-83.3040909,-83.3034547,-83.3035648,-83.3035305,-83.3035336,-83.303452,-83.3034172,-83.3035975,-83.30351,-83.3033834,-83.3034021,-83.3033912,-83.3034819,-83.303602,-83.3036097,-83.3035901,-83.3036196,-83.3035825,-83.3035919,-83.3035915,-83.3035485,-83.3035664,-83.3035457,-83.3022658,-83.3022824,-83.3032959,-83.3022477,-83.3049914,-83.3031866,-83.3031813,-83.2875257,-83.2836288,-83.2903487,-83.2953225,-83.2933542,-83.293686,-83.2975735,-83.2858912,-83.2864969],"lat":[8.4037017,8.40371,8.4036313,8.4036445,8.4043959,8.3985844,8.4059975,8.407144,8.4024861,8.4044843,8.4086914,8.4088136,8.4088001,8.4087545,8.4089467,8.4086395,8.4086949,8.4086049,8.4086764,8.4086361,8.4086045,8.4086349,8.4086806,8.4087425,8.4087188,8.4084766,8.4085748,8.4082983,8.4086106,8.4086365,8.4086203,8.4086064,8.4084827,8.4085996,8.4086541,8.4089393,8.4088795,8.4090214,8.4083916,8.40839,8.4083739,8.4049189,8.3935769,8.4015153,8.4024257,8.3937667,8.3904814,8.3904582,8.3905241,8.3904766,8.384099,8.391685,8.3920756,8.3911188,8.3919578,8.3954711,8.39221,8.399886,8.3919911,8.3989402,8.3956364,8.3946637,8.3938253,8.3965018,8.3901073,8.3900721,8.3901201,8.3901056,8.3900893,8.390089,8.3878832,8.395552,8.3920576,8.3951493,8.3995372,8.4001041,8.3917895,8.3999144,8.3990174,8.3953649,8.4009916,8.4044476,8.3985986,8.3967053,8.3995562,8.4021546,8.3969241,8.3980608,8.3981114,8.3980069,8.3980435,8.3980157,8.3980064,8.398007,8.3980307,8.3980547,8.3981317,8.398093,8.3981037,8.3981157,8.398114,8.3981225,8.3981086,8.3981172,8.3981294,8.3981171,8.3981461,8.3988392,8.3987242,8.3984612,8.3984396,8.3984631,8.3987009,8.3984623,8.3984465,8.3985839,8.398489,8.3986884,8.3987323,8.3987782,8.3988029,8.3986919,8.3988033,8.3987159,8.3989061,8.398517,8.39867,8.3988097,8.3990336,8.3991118,8.3988148,8.3986691,8.398694,8.3987757,8.3987837,8.3877893,8.3903012,8.3883384,8.3881169,8.3865693,8.3866311,8.3880835,8.3901109,8.3901142,8.390058,8.3933483,8.3999495,8.3941122,8.3875635,8.3764246,8.3886874,8.3975185,8.3918975,8.3869867,8.3997274,8.3952526,8.3936635,8.390339,8.3942793,8.3981472,8.3909336,8.398136,8.3900043,8.3886096,8.3839508,8.3870731,8.3868195,8.3859128,8.3897232,8.3965197,8.3970598,8.4088766,8.4000068,8.4115883,8.4307784,8.3951793,8.380933,8.3914671,8.3914495,8.3914318,8.3914188,8.3914502,8.3772657,8.384309,8.3844393,8.3816361,8.3866574,8.3927635,8.3916772,8.3916609,8.3916695,8.3915976,8.3914997,8.39171,8.3917608,8.3915659,8.3916519,8.3915374,8.3920554,8.3918874,8.3919325,8.3919314,8.3918646,8.391927,8.3919027,8.3919329,8.3919719,8.391952,8.3919449,8.3919085,8.3836097,8.3836,8.3844984,8.3836191,8.3821699,8.3887975,8.388316,8.3890358,8.3914899,8.3864561,8.3968227,8.3969949,8.3878378,8.3951238,8.3964363,8.3967863]}]],[[{"lng":[-83.240902,-83.2673409,-83.2705319,-83.2705975,-83.2647515,-83.2623439,-83.2379706,-83.2091824,-83.2238394,-83.227329,-83.2285865,-83.2502789,-83.2524993,-83.2623156,-83.2622638,-83.259316,-83.2593138,-83.2595671,-83.2592849,-83.259314,-83.2593316,-83.2593694,-83.2593769,-83.2596481,-83.2596462,-83.2596017,-83.259564,-83.2596146,-83.2596606,-83.2596313,-83.2596813,-83.259699,-83.2596616,-83.2595406,-83.2596404,-83.2596048,-83.2595925,-83.2600535,-83.2619689,-83.2619487,-83.2619255,-83.261932,-83.2620207,-83.2619229,-83.261914,-83.2611546,-83.2658434,-83.2858536,-83.2999197,-83.3032636,-83.3393988,-83.384682,-83.372145,-83.3690608,-83.3678502,-83.3761889,-83.3716293,-83.3611155,-83.3611568,-83.3611533,-83.3611345,-83.3611973,-83.3611323,-83.3612268,-83.3558681,-83.3533167,-83.3815676,-83.3565509,-83.3690541,-83.3957887,-83.4241988,-83.4236391,-83.4412686,-83.4434685,-83.4421318,-83.4587341,-83.4807631,-83.4807022,-83.4805248,-83.4808471,-83.4807287,-83.4805776,-83.4805396,-83.4795656,-83.4792954,-83.4792396,-83.479261,-83.4793931,-83.4792173,-83.4793473,-83.4795764,-83.4791656,-83.4797353,-83.4797555,-83.4798139,-83.4797941,-83.4796787,-83.479696,-83.4796358,-83.4796493,-83.4796367,-83.479681,-83.4796145,-83.479659,-83.4798409,-83.4800269,-83.4801299,-83.4796834,-83.4798568,-83.4796201,-83.4795694,-83.4794658,-83.4793489,-83.4798231,-83.479664,-83.4796569,-83.4796352,-83.479679,-83.4796311,-83.4794884,-83.4793802,-83.4797757,-83.4795315,-83.4796736,-83.4795293,-83.4796176,-83.4797311,-83.479607,-83.4796251,-83.4799008,-83.4793993,-83.4794241,-83.4794686,-83.4816874,-83.4855917,-83.4852231,-83.4852015,-83.4851058,-83.4852677,-83.4853188,-83.4853342,-83.4853082,-83.4853925,-83.4859917,-83.4639608,-83.4676972,-83.4896254,-83.4788233,-83.4786187,-83.4788692,-83.4786767,-83.4924354,-83.4875228,-83.5020642,-83.5365214,-83.5561023,-83.5569518,-83.5614034,-83.5798347,-83.599962,-83.6130085,-83.5888967,-83.5910487,-83.5912038,-83.5909099,-83.5890455,-83.5683597,-83.5209926,-83.520397,-83.5039645,-83.4522376,-83.4142268,-83.4079466,-83.3999678,-83.4157683,-83.4341941,-83.4196122,-83.4184588,-83.4073071,-83.4055792,-83.4167176,-83.4073165,-83.4076906,-83.4080105,-83.4080691,-83.4079876,-83.4079928,-83.4078461,-83.407979,-83.4079264,-83.4079634,-83.407939,-83.4079455,-83.4077521,-83.4074212,-83.4078137,-83.4079246,-83.4082453,-83.4098018,-83.4097568,-83.409357,-83.4096488,-83.4093636,-83.4094077,-83.4093692,-83.4094065,-83.409428,-83.4093949,-83.4094122,-83.4099273,-83.4091228,-83.4088918,-83.4059925,-83.3978027,-83.401413,-83.4240854,-83.4205874,-83.4362308,-83.470398,-83.4601203,-83.4600298],"lat":[8.9809676,8.9913538,8.9639094,8.9638699,8.9591176,8.9627867,8.9566789,8.9328062,8.9661796,8.9759714,8.9726404,8.9618957,8.952791,8.9426298,8.9426026,8.9459021,8.9458695,8.9458698,8.9458496,8.9458916,8.9458732,8.9458861,8.9458313,8.9465869,8.9465923,8.9465742,8.9465693,8.9465603,8.9465906,8.9465484,8.9465765,8.9466305,8.9465794,8.9465665,8.9465979,8.9466188,8.9466148,8.9414682,8.9395988,8.9395998,8.9395873,8.939607,8.9396302,8.9395863,8.9395805,8.9362885,8.928438,8.9249222,8.906139,8.9113777,8.9286548,8.9334489,8.9188396,8.9259078,8.9258673,8.9140474,8.8921943,8.8882112,8.8881073,8.888111,8.8881273,8.888132,8.8881132,8.8886058,8.8882896,8.9177212,8.9671755,8.9719656,8.9774738,8.9803356,8.9816688,8.9805535,8.9835455,8.9881683,8.9892843,8.9892954,8.9994006,8.9990846,8.9991125,8.9994237,8.9991041,8.99925,8.9992907,9.0017612,8.9999272,8.9999381,8.9999191,8.999901,8.9998344,8.9998889,8.9997898,8.9997428,8.9996822,8.9996671,8.9997412,8.9996771,8.99974,8.9997214,8.9996528,8.9997366,8.9997863,8.9997166,8.9997665,8.9997907,8.9993328,9.000281,8.9996197,8.999731,8.9996853,8.9997533,8.9998091,8.9997984,8.9995295,8.9998481,8.9999131,8.9996496,8.9995929,8.9997359,8.9996594,8.9996135,8.9996551,8.9995843,8.9996522,8.9994344,8.9995015,8.9996105,8.9994173,8.9995505,8.9993626,8.9994953,8.9995359,8.9994745,8.9995261,8.9995334,8.9691334,8.9683612,8.9683928,8.968417,8.9683954,8.9684438,8.9684461,8.9685312,8.9681187,8.9709984,8.9858682,8.9830317,9.0031566,8.9996452,8.9995429,8.9996502,8.9979657,8.9943083,9.0011034,9.023275,9.0117123,9.0223139,9.0208878,9.0220779,9.0238004,9.0262614,9.0563659,9.0706353,9.0763829,9.0763218,9.0755511,9.0716954,9.0601689,9.0350289,9.0415518,9.061688,9.0936794,9.0756473,9.0721284,9.0601814,9.0301032,9.0227785,8.9892219,8.9868568,8.9721801,8.9722343,8.9766512,8.9789938,8.9811015,8.9809239,8.9810009,8.980915,8.9808487,8.9807755,8.9808337,8.9807773,8.9808606,8.9808605,8.9808099,8.9810306,8.9805707,8.9808036,8.9807993,8.9795929,8.967837,8.9679225,8.9677923,8.9677315,8.9677809,8.9678171,8.9678268,8.9678298,8.9678575,8.9678388,8.9678712,8.9684767,8.9677162,8.9675226,8.9682723,8.9713413,8.9746613,8.9816858,8.9728707,8.9816663,8.9897203,8.9757807,8.9765909]}]],[[{"lng":[-83.3191824,-83.3190827,-83.319658,-83.3192809,-83.3191812,-83.3192294,-83.3198568,-83.3197373,-83.3197075,-83.3197534,-83.3195339,-83.3195932,-83.3196696,-83.3202617,-83.3202701,-83.3203122,-83.3203599,-83.3214253,-83.3213165,-83.3213681,-83.3225201,-83.3216701,-83.3212102,-83.321476,-83.3214918,-83.3214575,-83.3164704,-83.3164142,-83.3164414,-83.3164257,-83.316685,-83.3173545,-83.3166637,-83.316435,-83.3167705,-83.3171075,-83.3167714,-83.3177054,-83.3178409,-83.3179642],"lat":[8.5191059,8.5190194,8.5190458,8.51895,8.5189635,8.5190646,8.5198342,8.5198157,8.5198598,8.5199333,8.520192,8.5197893,8.5199134,8.5196767,8.5196779,8.5195692,8.5195999,8.5197823,8.5197105,8.5197358,8.5198492,8.5198122,8.519635,8.5196955,8.5197294,8.5199418,8.5227525,8.5227371,8.5226818,8.5225542,8.5224445,8.5226535,8.5229979,8.5222826,8.5225212,8.5218425,8.5224221,8.5227348,8.5229725,8.5229743]}]],[[{"lng":[-83.5530252,-83.5530009,-83.5530562,-83.5529884,-83.5528883,-83.5532939,-83.5531865,-83.5531099,-83.5532424,-83.5531306,-83.5526808,-83.5530597,-83.5531232,-83.55198,-83.5519712,-83.5520304,-83.551837,-83.5520397,-83.552079,-83.551961,-83.5520205,-83.5542554,-83.5542994,-83.5543007,-83.5542677,-83.554304,-83.5542859,-83.5543975,-83.5542413,-83.5586447,-83.5586371,-83.5585606,-83.5586993,-83.5586375,-83.5585366,-83.5587234,-83.5589568,-83.5585744,-83.5582001,-83.5582608,-83.5581492,-83.5583203,-83.5583203,-83.5585054,-83.5581834,-83.5583345,-83.5583742,-83.558346,-83.5570179,-83.5670985,-83.5675808,-83.5692567,-83.5638379,-83.5940658,-83.6208112,-83.6352544,-83.6149924,-83.6186721,-83.6056703,-83.6031566,-83.6157426,-83.647102,-83.6034803,-83.571191,-83.591106,-83.576978,-83.5925545,-83.5814558,-83.6000738,-83.6081541,-83.571592,-83.5602732,-83.5299259,-83.5469044,-83.5265334,-83.5460231,-83.5471024,-83.5469977,-83.5468675,-83.5442786,-83.5305916,-83.5226527,-83.5143504,-83.5071399,-83.4724794,-83.47249,-83.4724541,-83.4724862,-83.4724664,-83.4724602,-83.4724808,-83.4770972,-83.4770813,-83.4770481,-83.4769927,-83.4770447,-83.4769971,-83.4770179,-83.4770076,-83.4769497,-83.4770004,-83.4769982,-83.477007,-83.4771472,-83.4767026,-83.4767766,-83.4770279,-83.4771572,-83.4770966,-83.4769776,-83.4770061,-83.4770747,-83.4770063,-83.4770988,-83.4770807,-83.477045,-83.4768465,-83.4570506,-83.4232472,-83.3975304,-83.3716294,-83.3442408,-83.3382038,-83.313425,-83.294152,-83.2941389,-83.2941947,-83.2943545,-83.2946484,-83.2941868,-83.2943144,-83.2943333,-83.2941374,-83.2940523,-83.2940757,-83.2942404,-83.2941584,-83.29429,-83.2942804,-83.2942005,-83.294018,-83.2939512,-83.2940974,-83.2940891,-83.2941171,-83.2940347,-83.2941202,-83.2940067,-83.2946762,-83.2947593,-83.2947939,-83.2948118,-83.2948328,-83.2949531,-83.2948318,-83.294843,-83.2948276,-83.29478,-83.2947664,-83.2947758,-83.2948105,-83.2949204,-83.2947764,-83.2947851,-83.2948932,-83.2947423,-83.2947421,-83.2948393,-83.2940012,-83.2940876,-83.2944134,-83.2940514,-83.2944284,-83.2947792,-83.2951337,-83.2949135,-83.294886,-83.2949456,-83.2948522,-83.2948943,-83.2948796,-83.2952377,-83.2947882,-83.2947953,-83.2949243,-83.29504,-83.2948398,-83.294774,-83.2948862,-83.2948594,-83.2948337,-83.2946963,-83.2948284,-83.2948825,-83.2948023,-83.2942866,-83.2942401,-83.2942575,-83.2942714,-83.294155,-83.2940451,-83.2941563,-83.2940739,-83.2940052,-83.2941305,-83.2940687,-83.2936349,-83.293693,-83.2939358,-83.2939567,-83.2938819],"lat":[8.5121834,8.5122793,8.5123013,8.5120393,8.5120748,8.5120347,8.512027,8.5119172,8.5121916,8.5119077,8.51203,8.5119679,8.5112997,8.5109363,8.5108946,8.5107543,8.5109057,8.5107785,8.5110106,8.5109864,8.5109505,8.5158045,8.5158012,8.5158595,8.5157793,8.5158472,8.5157886,8.5158688,8.5157896,8.5166248,8.5166077,8.5166173,8.5165574,8.516612,8.5163638,8.5166104,8.5163443,8.5166308,8.5175787,8.5177427,8.5179312,8.5176874,8.5177039,8.5172357,8.517596,8.5176632,8.5176375,8.5176743,8.51936,8.5274218,8.5273476,8.5447654,8.5386025,8.5238594,8.5409986,8.5501533,8.5648691,8.5721909,8.5751869,8.5589388,8.5586174,8.5821238,8.602613,8.6039398,8.6099809,8.6055859,8.5691023,8.5361156,8.5121461,8.5139096,8.4784573,8.4698712,8.4686468,8.4629819,8.4814954,8.4798376,8.4771991,8.4771453,8.4770753,8.4754083,8.4822801,8.456804,8.4582833,8.4463061,8.4533861,8.4531505,8.4531626,8.4531665,8.4531847,8.4531209,8.4530822,8.4543439,8.4543584,8.4544046,8.4545655,8.4543993,8.454403,8.4544027,8.4543729,8.4544171,8.4543709,8.4543563,8.4545431,8.4542068,8.4544619,8.4544898,8.4543815,8.454536,8.4544475,8.4544658,8.4543823,8.4542139,8.4541987,8.4543685,8.4544234,8.4544089,8.4538974,8.4508694,8.4397752,8.4466657,8.4371441,8.4306536,8.4220187,8.4290305,8.440291,8.4402731,8.440254,8.4403084,8.4403093,8.4404655,8.4404429,8.4406063,8.440464,8.4404133,8.440446,8.4404644,8.4403633,8.4404106,8.4404502,8.4404528,8.4404106,8.4403722,8.4403659,8.4404007,8.4404096,8.4405107,8.4404188,8.4404118,8.4395659,8.4395615,8.4395197,8.439521,8.4395166,8.4393949,8.439475,8.4395122,8.4395466,8.4395787,8.4395449,8.4395465,8.4395225,8.4394218,8.4395288,8.4394631,8.4393875,8.4395501,8.4395557,8.43947,8.4398909,8.439833,8.4386062,8.4385614,8.4386527,8.4385727,8.4384958,8.4386404,8.4386085,8.4386647,8.438633,8.4384958,8.4385795,8.4386611,8.4385304,8.4385125,8.4387124,8.4386391,8.4386204,8.4384956,8.4385943,8.4387244,8.4386198,8.4389456,8.4394369,8.439703,8.4395321,8.440613,8.440555,8.4406416,8.4406234,8.4404807,8.4403326,8.4403949,8.440495,8.4403877,8.4403743,8.4405072,8.4411939,8.4412004,8.4412264,8.441235,8.4412025]}]],[[{"lng":[-83.5131903,-83.5157744,-83.5129184,-83.5130609,-83.5127913,-83.5131467,-83.5129811,-83.513071,-83.5130814,-83.5132943,-83.5199831,-83.529696,-83.5308496,-83.5403763,-83.5407491,-83.5287733,-83.5229376,-83.523129,-83.5231406,-83.5231559,-83.516505,-83.5373364,-83.5431166,-83.5473498,-83.5457687,-83.5469052,-83.5463372,-83.5144924,-83.5080582,-83.5038152,-83.4900292,-83.4892585,-83.4893844,-83.5073496,-83.5243332,-83.5158741,-83.50965,-83.5348353,-83.5344076,-83.5272494,-83.5268442,-83.5268998,-83.5532383,-83.5683515,-83.5653855,-83.5487298,-83.5489891,-83.5488628,-83.5488995,-83.5495455,-83.5487731,-83.5487848,-83.521507,-83.5216584,-83.5137447,-83.5287168,-83.5286915,-83.5277346,-83.5235154,-83.5159935,-83.5260788,-83.5152365,-83.5130802,-83.5126025,-83.5132699,-83.5123774],"lat":[8.5123249,8.5106487,8.5124247,8.5124176,8.5125299,8.51258,8.5124632,8.5124574,8.5125385,8.512999,8.5109554,8.5060251,8.4801214,8.4455385,8.4439904,8.4476351,8.4576113,8.4574741,8.4574096,8.4574899,8.4619493,8.4451031,8.4437148,8.4471607,8.4502256,8.4489172,8.4553252,8.4554744,8.4595414,8.4618008,8.4699,8.4704954,8.471965,8.4607494,8.4539866,8.4561674,8.4662845,8.4543627,8.4512229,8.4527917,8.4532213,8.453032,8.4427809,8.4508893,8.4595983,8.4500221,8.4500102,8.4499554,8.4500362,8.4507115,8.4500178,8.4498328,8.4525036,8.452151,8.455403,8.4560449,8.456035,8.4546469,8.4570356,8.4530927,8.4528009,8.4524433,8.4542668,8.4538623,8.4559954,8.4555991]}]],[[{"lng":[-83.3206835,-83.320763,-83.3208554,-83.3210137,-83.3213989,-83.3211818,-83.3217599,-83.2961415,-83.3894706,-83.3911275,-83.4308293,-83.4305437,-83.4306468,-83.4232274,-83.4098018,-83.3784807,-83.3582403,-83.3583046,-83.3582383,-83.3581191,-83.3554526,-83.3554519,-83.3547734,-83.3550348,-83.3549206,-83.355461,-83.3557665,-83.3557811,-83.3551775,-83.3558006,-83.3556127,-83.3556486,-83.355551,-83.3555891],"lat":[8.4727651,8.4727831,8.4727205,8.4728711,8.4725014,8.4728546,8.4727582,8.4024448,8.4463268,8.4461704,8.4480738,8.4479028,8.4478243,8.4373244,8.4436657,8.4416462,8.4135196,8.4134613,8.4134251,8.4134795,8.4218689,8.4221498,8.4223942,8.4224897,8.4224819,8.4222728,8.4223385,8.4221761,8.4218399,8.4220217,8.4220472,8.4218549,8.4218093,8.4218077]}]],[[{"lng":[-83.3470776,-83.3478688,-83.3482198,-83.3478341,-83.3481954,-83.348524,-83.3483871,-83.349072,-83.3177711,-83.3177797,-83.3165575,-83.3097067,-83.313569,-83.3444901,-83.3714815,-83.3768254,-83.3767819,-83.3773843,-83.3694595,-83.3697517,-83.3692945,-83.3695614,-83.3696274,-83.369579,-83.3695993,-83.3684256,-83.3647353,-83.3647313,-83.364374,-83.3675444,-83.3648114,-83.3653483,-83.3337633,-83.3012096,-83.3011983,-83.2978697,-83.3057679,-83.3053646,-83.3259803,-83.3206602,-83.3209438,-83.3228585,-83.3208187,-83.3208461,-83.3209337,-83.3208506,-83.3207299,-83.3208343,-83.3209676,-83.320963,-83.320896,-83.3144596,-83.3473934,-83.3697378,-83.3576095,-83.3562731,-83.3572448,-83.3562503,-83.3561174,-83.3519599],"lat":[8.5222359,8.5216459,8.5207674,8.5208301,8.5207894,8.5211281,8.5212072,8.5206114,8.5150339,8.5148505,8.5112814,8.5164537,8.493426,8.4951341,8.5073209,8.504268,8.5042111,8.5039638,8.5069636,8.5068101,8.5069701,8.5068598,8.5068955,8.5068736,8.5068794,8.5070901,8.5098476,8.5097859,8.5109567,8.5116922,8.5005175,8.5214915,8.5098276,8.5115796,8.4964217,8.4775933,8.5327868,8.5215236,8.5173796,8.4955168,8.4954366,8.4946194,8.4955755,8.4955587,8.4951935,8.4954481,8.4954806,8.4953169,8.4955306,8.495336,8.4955102,8.5130333,8.5094135,8.513499,8.5191661,8.518733,8.5193291,8.5297327,8.5294514,8.5136843]}]],[[{"lng":[-83.572902,-83.5731888,-83.5717597,-83.571829,-83.5721271,-83.5718804,-83.5727664,-83.5723428,-83.5725901,-83.5726717,-83.5726515,-83.5726415,-83.5726296,-83.5730072,-83.6036077,-83.5906182,-83.5735498,-83.5663367,-83.5204526,-83.5086666,-83.5086803,-83.5086497,-83.5095022,-83.5226682,-83.5128499,-83.511134,-83.509669,-83.5301768,-83.5134943,-83.5133736,-83.5133234,-83.5133669,-83.5160536,-83.5160376,-83.5160824,-83.516012,-83.5377823,-83.5717033,-83.5780646,-83.5749783,-83.5658938,-83.5353861,-83.5424159,-83.522808,-83.5223542,-83.5228069,-83.5131348,-83.5157003,-83.5131023,-83.5130194],"lat":[8.6487759,8.6484983,8.6471763,8.6470328,8.6471677,8.6471322,8.6486683,8.647328,8.6475622,8.6475611,8.6474944,8.6473916,8.6474889,8.6468289,8.5248086,8.5124087,8.4884047,8.4817998,8.4967769,8.4965333,8.4964525,8.4964449,8.4889259,8.4583452,8.4583996,8.4667879,8.4660902,8.4663855,8.4586088,8.4587155,8.4589308,8.4586762,8.456686,8.4566237,8.4566028,8.4566408,8.4591333,8.472452,8.47379,8.482535,8.4948707,8.5054326,8.4941402,8.4576834,8.4572904,8.4570445,8.4543818,8.4554912,8.4563788,8.4569031]}]],[[{"lng":[-83.1242462,-83.1129802,-83.1127984,-83.1128644,-83.1125455,-83.1121701,-83.1126588,-83.1131213,-83.1130612,-83.1131414,-83.1133435,-83.098938,-83.0989684,-83.0916315,-83.081746,-83.1058182,-83.0972278,-83.086157,-83.0957213,-83.0798163,-83.054686,-83.0580986,-83.0693532,-83.0709931,-83.0664938,-83.0664105,-83.0663021,-83.0666596,-83.0666152,-83.0666218,-83.0666223,-83.0661362,-83.0661637,-83.0661235,-83.0664755,-83.0662095,-83.0664371,-83.0572852,-83.0567321,-83.0436767,-83.0615243,-83.0309287,-83.028233,-83.0366151,-83.0493375,-83.0653509,-83.0678312,-83.0343691,-83.0354697,-83.0202381,-83.020446,-83.020415,-82.9952245,-82.9966882,-83.0204281,-83.018164,-83.0162594,-83.0188608,-83.0188739,-83.0187818,-83.0187934,-83.0188682,-83.0187852,-83.0193364,-83.0191895,-83.0190679,-83.0187641,-83.0189811,-83.0186549,-83.0189122,-83.0204824,-83.0199202],"lat":[8.6093178,8.6099232,8.6090753,8.6091977,8.6095288,8.609248,8.6092769,8.6094167,8.6095767,8.6096631,8.609685,8.6092371,8.6090669,8.6149492,8.6072557,8.6161772,8.6021082,8.6100322,8.5849774,8.5524037,8.5217753,8.5188073,8.5122734,8.5123382,8.5383866,8.5379142,8.5380583,8.5382993,8.5382896,8.5383092,8.5384025,8.5379933,8.538018,8.5380557,8.5381492,8.5379705,8.5378296,8.538658,8.5386206,8.5054184,8.4661408,8.4197204,8.4119629,8.4137286,8.3658627,8.3579086,8.316399,8.3005505,8.2983984,8.3019348,8.3019253,8.3019317,8.2807613,8.2816758,8.2952334,8.2881804,8.2850971,8.2830422,8.2828856,8.2830384,8.2830523,8.2829808,8.2829181,8.282633,8.2827626,8.2828521,8.283085,8.2830899,8.2828773,8.2832781,8.2761738,8.2762644]}]],[[{"lng":[-83.3540716,-83.3552353,-83.3573851,-83.3577678,-83.3578148,-83.3578214,-83.3523832,-83.3518481,-83.351978,-83.3530809,-83.3528568,-83.3524088,-83.3524298,-83.3524943,-83.352655,-83.351695,-83.3510227,-83.3510869],"lat":[8.4454803,8.4420615,8.4593975,8.4615375,8.4615514,8.4615317,8.4668124,8.4677488,8.4677264,8.4662972,8.4664925,8.4667431,8.4667,8.4669509,8.4672439,8.4673084,8.4624742,8.4626196]}]],[[{"lng":[-83.5283386,-83.5280735,-83.5280478,-83.5280134,-83.5281417,-83.5279142,-83.528127,-83.5279947,-83.5279982,-83.5281055,-83.5282329,-83.5281918,-83.5279501,-83.5272557,-83.5277083,-83.5276555,-83.5275916,-83.5275451,-83.5275035,-83.5277099,-83.527552,-83.5275971,-83.5274999,-83.5275994,-83.5274834,-83.5276155,-83.5275394,-83.5276105,-83.5276037,-83.5276329,-83.527703,-83.5275928,-83.5275279,-83.5276674,-83.5278772,-83.5278868,-83.5278382,-83.5280399,-83.5279534,-83.5276746,-83.5278067,-83.5280755,-83.5277415,-83.528355,-83.5278966,-83.5279887,-83.528268,-83.5286337,-83.5281451,-83.52808,-83.52539,-83.518411,-83.493407,-83.4889791,-83.4885014,-83.48789,-83.4879317,-83.4881921,-83.4915688,-83.498215,-83.4982678,-83.4983647,-83.4990099,-83.5057963,-83.5058185,-83.5058977,-83.5058032,-83.5008699,-83.4625902,-83.4010563,-83.3603146,-83.3426904,-83.3067799,-83.2881922,-83.2773714,-83.2419126,-83.2065186,-83.2195643,-83.2063553,-83.191966,-83.1599715,-83.1517323,-83.1763686,-83.2063464,-83.2066895,-83.2071104,-83.207133,-83.2072227,-83.207867,-83.2078794,-83.2094245,-83.2128099,-83.2147603,-83.2183771,-83.2021086,-83.2021584,-83.202103,-83.2020765,-83.2021099,-83.2021025,-83.2020695,-83.2020792,-83.202071,-83.2020901,-83.2020668,-83.2020585,-83.2020755,-83.2020847,-83.2021002,-83.2020741,-83.2021044,-83.2020771,-83.2020525,-83.2020529,-83.2020487,-83.2020791,-83.2020921,-83.2020695,-83.202091,-83.2020951,-83.2020347,-83.2020827,-83.2019421,-83.2020482,-83.2020205,-83.2019841,-83.2020655,-83.2020915,-83.2075628,-83.2075444,-83.2075379,-83.207533,-83.207595,-83.2075878,-83.2075927,-83.2071233,-83.2073015,-83.2072752,-83.2071082,-83.2071198,-83.2071236,-83.2087816,-83.2088386,-83.2086637,-83.2364412,-83.2518902,-83.2885496,-83.2645849,-83.2418547,-83.2522069,-83.2325839,-83.1950711,-83.2016946,-83.215455,-83.2388688,-83.2682764,-83.2909279,-83.31285,-83.3203684,-83.3325546,-83.3563852,-83.3679834,-83.3570925,-83.40729,-83.46578,-83.4869109,-83.4553619,-83.4575334,-83.4626313,-83.4662248,-83.4661163,-83.4661752,-83.4663084,-83.4662316,-83.4663146,-83.4662139,-83.4662235,-83.4661224,-83.4661637,-83.466211,-83.4661684,-83.4661223,-83.46617,-83.4662053,-83.4661708,-83.4661349,-83.4661492,-83.4661354,-83.466166,-83.4661979,-83.4661934,-83.4661616,-83.46622,-83.4662063,-83.4662382,-83.4662216,-83.466227,-83.4662488,-83.4662142,-83.4663621,-83.4662235,-83.4662589,-83.4662195,-83.466225,-83.4662469,-83.4661887,-83.4662175,-83.4662295,-83.4662079,-83.4662948,-83.4663003,-83.4663385,-83.4663883,-83.4661745,-83.4662554,-83.4661728,-83.4661783,-83.4662076,-83.4661886,-83.4661419,-83.4661708,-83.46615,-83.4661198,-83.4661329,-83.4661478,-83.4661098,-83.4660552],"lat":[9.0292109,9.0290573,9.0292865,9.0292284,9.0292538,9.0290489,9.0292169,9.0291388,9.0291426,9.0291494,9.0291879,9.0292436,9.0290809,9.0286742,9.0285478,9.0285781,9.0284967,9.0285135,9.0285122,9.0286053,9.0286306,9.028534,9.0284242,9.0284654,9.0283749,9.0285233,9.0283923,9.0284794,9.0284116,9.0284742,9.0284823,9.0284532,9.0284572,9.0284661,9.0287047,9.0287588,9.0287266,9.0287061,9.0287794,9.0288508,9.0288394,9.0288066,9.0285892,9.0293191,9.0292186,9.0291667,9.0292712,9.029439,9.0292506,9.0291584,9.0177572,9.0104744,8.9946465,9.0108586,9.0119186,9.012694,9.0126548,9.01207,9.0081293,9.0316133,9.0320141,9.0319758,9.0309494,9.0344579,9.0344627,9.0345216,9.0345177,9.0191535,8.9905513,8.980437,8.9287614,8.9186373,8.900116,8.870037,8.8629224,8.9120417,8.9262955,8.9202424,8.926498,8.9025595,8.8779814,8.9031306,8.9303707,8.927116,8.9278109,8.9276592,8.9276529,8.9276241,8.927414,8.9274317,8.9270426,8.9278741,8.9280713,8.9207561,8.9272317,8.9272603,8.9272507,8.9273257,8.9273241,8.9273163,8.9272668,8.9272752,8.927253,8.927247,8.9272717,8.9272327,8.9272508,8.9273124,8.9273055,8.927245,8.9272453,8.9272226,8.9272912,8.9272235,8.9272598,8.9272667,8.9271608,8.9273161,8.9272252,8.9272462,8.9272241,8.9272118,8.9272756,8.9272628,8.9272324,8.9272902,8.9272123,8.9272554,8.9276457,8.9276404,8.9276566,8.9276577,8.9276427,8.9276199,8.9276943,8.9275517,8.9274057,8.9274236,8.9276228,8.9276479,8.9275986,8.9268708,8.9268788,8.911549,8.879006,8.8153342,8.7715737,8.7482243,8.7217483,8.6676079,8.6530415,8.6588003,8.6794198,8.6752573,8.6529178,8.6771587,8.6898234,8.7019653,8.7471862,8.7535552,8.7814642,8.8014566,8.8057944,8.7788712,8.7448826,8.677253,8.6089026,8.6176367,8.5881886,8.5861321,8.5861767,8.5861534,8.5861634,8.5861991,8.5862429,8.5861761,8.586107,8.5862016,8.5861835,8.5861362,8.5861963,8.5861385,8.5861519,8.5862021,8.5861531,8.5861794,8.5862107,8.5862552,8.586224,8.5861819,8.5861226,8.5861991,8.5862144,8.5861591,8.5861971,8.5861467,8.586187,8.5861313,8.5861375,8.5862373,8.5861128,8.5861689,8.5861201,8.5861101,8.5863291,8.5863317,8.5861651,8.5861588,8.5861798,8.5861031,8.5862154,8.5862215,8.5862469,8.5860943,8.5861267,8.586107,8.5861138,8.5859479,8.5861491,8.586127,8.5860983,8.5861369,8.586105,8.5861157,8.5861151,8.5861232,8.5861379]}]],[[{"lng":[-83.5385492,-83.5260433,-83.5267586,-83.5194494,-83.5321609,-83.5636894,-83.5673624,-83.523169,-83.5151488,-83.5084288,-83.508374,-83.5084177,-83.5079818,-83.5079307,-83.508162,-83.5082823,-83.5052269,-83.5300969,-83.5500159,-83.5771704,-83.5993456,-83.6232876,-83.6415214,-83.6505025,-83.6506516,-83.6944163,-83.6801274,-83.640102,-83.6163531,-83.5827218,-83.5790476,-83.5171756,-83.5132809,-83.5185356,-83.5194094,-83.4820935,-83.4207015,-83.4071733,-83.3447425,-83.3525478,-83.3858092,-83.3845028,-83.3844266,-83.3780487,-83.4046147,-83.4047093,-83.4006589,-83.3873809,-83.3871212,-83.4000528,-83.4612049,-83.4731169,-83.4918814,-83.4917886,-83.4915458,-83.4930759,-83.4931491,-83.4966144,-83.4954027,-83.4955437,-83.5197383,-83.5203032,-83.532893,-83.5485473,-83.5494998,-83.56155,-83.6020789,-83.5937475,-83.6014965,-83.5864979,-83.5865575,-83.586236,-83.5860785,-83.6362034,-83.6465943,-83.6205822,-83.6225272,-83.6361583,-83.636237,-83.6766132,-83.7120154,-83.7452073,-83.7580791,-83.7579334,-83.7582101,-83.8432578,-83.8446809,-83.8207995,-83.8318543,-83.8324388,-83.8325858,-83.8324432,-83.8324876,-83.832504,-83.832501,-83.8323715,-83.8166253,-83.7984464,-83.7893834,-83.7773028,-83.7638813,-83.7647115,-83.7646864,-83.7663379,-83.7735789,-83.7733364,-83.7731517,-83.7732579,-83.7734083,-83.7736134,-83.7732597,-83.7732419,-83.7737738,-83.7732307,-83.786113,-83.8187871,-83.8307675,-83.8309873,-83.8282016,-83.8281191,-83.8281738,-83.8281461],"lat":[8.4476711,8.4503697,8.4542116,8.4611697,8.4514741,8.4569732,8.4554171,8.4658695,8.4651083,8.4690688,8.4691251,8.4691077,8.469847,8.4699354,8.4696162,8.4696689,8.4610316,8.4921405,8.5097579,8.5145473,8.5526468,8.5577553,8.5996547,8.6109086,8.6103162,8.6426218,8.6607692,8.6897744,8.7265024,8.7368428,8.7645994,8.8111978,8.8205579,8.8139934,8.8153374,8.8017775,8.8107007,8.8210115,8.8751706,8.9239491,8.9311289,8.9297183,8.9296794,8.944605,8.9553711,8.9559327,8.9571573,8.9539532,8.9669953,8.9757966,8.9914935,8.9975805,9.0123885,9.0124174,9.0128871,9.0114411,9.0119235,9.0112366,9.0108154,9.0107873,8.9960505,9.0039019,9.0227022,9.0455764,9.0470317,9.047556,9.054631,9.073828,9.0888025,9.080314,9.0775271,9.0777128,9.0790919,9.0944479,9.1200041,9.0954006,9.11144,9.1129618,9.1176205,9.1151879,9.1430608,9.1844483,9.1892628,9.1893011,9.1892427,9.2494751,9.2927468,9.3319408,9.3075151,9.3072212,9.3072455,9.3071864,9.3072402,9.3072004,9.3072333,9.3095836,9.3284294,9.3022364,9.2718925,9.2435167,9.2386201,9.2427271,9.2426531,9.2394807,9.2104003,9.2103682,9.2104904,9.2103368,9.2103803,9.21025,9.2103314,9.2102918,9.2091962,9.2094248,9.2656362,9.3094748,9.3091827,9.3128955,9.3068748,9.306735,9.3067477,9.3067756]}]],[[{"lng":[-83.0601283,-83.0601427,-83.0628682,-83.0628805,-83.0628932,-83.0628651,-83.0627926,-83.062794,-83.062892,-83.0628416,-83.0617477,-83.0617523,-83.061609,-83.0616179,-83.0615689,-83.061616,-83.0616034,-83.0616972,-83.0616519,-83.0614672,-83.0616356,-83.06163,-83.0614712,-83.0616597,-83.0612555,-83.0617706,-83.061574,-83.0615434,-83.0616239,-83.0615862,-83.0616116,-83.0616259,-83.0616896,-83.0588007,-83.058835,-83.0588226,-83.0587298,-83.0587833,-83.0583848,-83.0582993,-83.0582844,-83.0583348,-83.0582281,-83.0582717,-83.0582613,-83.0582912,-83.0583325,-83.058086,-83.0585897,-83.0583581,-83.0584001,-83.0583345,-83.057923,-83.0619676,-83.061928,-83.0618739,-83.0626032,-83.0625913,-83.062677,-83.0684448,-83.0902857,-83.1381623,-83.1801089,-83.2268245,-83.2852595,-83.3106042,-83.3364154,-83.3672752,-83.411316,-83.4404917,-83.4855613,-83.5112312,-83.5067244,-83.5103937,-83.5687435,-83.5605243],"lat":[8.6942381,8.6942531,8.6957302,8.6957688,8.6957253,8.6956728,8.6956453,8.6956415,8.6956832,8.695717,8.6973032,8.6972796,8.698828,8.699004,8.698914,8.6989604,8.6990963,8.6990369,8.6991544,8.6989707,8.6990047,8.6990916,8.6990171,8.6990505,8.6989992,8.6989071,8.6990869,8.6990857,8.6991678,8.6990488,8.6990521,8.6990882,8.6990535,8.6963269,8.6962201,8.6962517,8.6962357,8.6962989,8.6955087,8.6954532,8.6954778,8.6954983,8.695516,8.6954882,8.6954879,8.6954145,8.6952697,8.6954413,8.6956446,8.6955388,8.6954742,8.6954277,8.6959992,8.6965918,8.6965048,8.6969839,8.6974622,8.6973895,8.6975108,8.6933729,8.6964776,8.6729698,8.7136997,8.7432693,8.744088,8.7702179,8.7998766,8.7935925,8.7678898,8.7715065,8.7547153,8.7471635,8.7350963,8.694033,8.6682607,8.658614]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":["#30123BFF","#4040A2FF","#466BE3FF","#4293FFFF","#28BBECFF","#18DCC3FF","#31F299FF","#6BFE64FF","#A2FC3CFF","#CCED34FF","#EDD03AFF","#FDAD35FF","#FB8022FF","#EC520FFF","#D23105FF","#AC1701FF","#7A0403FF"],"weight":3,"opacity":0.3,"fill":false,"fillColor":["#30123BFF","#4040A2FF","#466BE3FF","#4293FFFF","#28BBECFF","#18DCC3FF","#31F299FF","#6BFE64FF","#A2FC3CFF","#CCED34FF","#EDD03AFF","#FDAD35FF","#FB8022FF","#EC520FFF","#D23105FF","#AC1701FF","#7A0403FF"],"fillOpacity":0.2,"smoothFactor":1,"noClip":false},["Attenborough_Sarcoramphus","Carolina_Sarcoramphus","Charizard_Sarcoramphus","Elvis_Sarcoramphus","Forsyth_Sarcoramphus","Fossey_Sarcoramphus","Frosty_Sarcoramphus","Goodall_Sarcoramphus","Jatayu_Sarcoramphus","Messi_Sarcoramphus","Moskovits_Sarcoramphus","Robin Hood_Sarcoramphus","Rocky_Sarcoramphus","Santa_Sarcoramphus","Ugalde_Sarcoramphus","Wencelas_Sarcoramphus","Wilson_Sarcoramphus"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addCircleMarkers","args":[[8.58980455001732,8.62310905002506,8.58984335001014,8.58865750001455,8.62345055000812,8.62268485001214,8.62339190001049,8.62291090000242,8.623358100011,8.91767470004089,8.75258390003541,8.84571330000007,8.84680700000087,9.3690274500134,9.38624615000191,9.36892960000309,9.36675465000013,9.38132410000527,9.38152070003166,9.38541510000196,9.37830340002469,8.41651285000485,8.39064630001502,8.40805875000118,8.39087960000185,8.39807660000237,8.40860955002439,8.39864615000365,8.39191825000007,8.99969700001082,8.94659850000849,8.99957375004644,8.96777915002649,8.98090395001072,8.51958455000074,8.51985135000198,8.51901405000081,8.52249935002172,8.5198186500005,8.51972315000086,8.5120547500529,8.43947160000746,8.44039550000912,8.45433225000072,8.44047800001687,8.43856735002269,8.51249795000008,8.42248580000415,8.47267800001588,8.42183210000304,8.49537610000331,8.50687765000141,8.52080975004202,8.49542310000163,8.64714995001987,8.45662180000159,8.53835585000006,8.60967405001328,8.28294945000218,8.53790005001683,8.28298360003359,8.46709740000881,8.4677376000054,9.0291184000347,9.02882870005471,9.02843730000916,8.58619685000015,8.92724370000668,8.58613615000202,8.46964255000465,9.21031160000012,8.69535550002013,8.69903745000751],[-83.4276896500003,-83.4330680500231,-83.4276622499841,-83.4276733500303,-83.4334353499932,-83.4330581500087,-83.433230949968,-83.433011799994,-83.4333823499953,-83.1266064499962,-83.4332401999339,-83.2363137500003,-83.2357908499961,-83.8605739500022,-83.8976361500009,-83.8604935999988,-83.8570058499993,-83.8948566500013,-83.8947449999838,-83.8981748499994,-83.893139900006,-83.3183638500031,-83.3237782499678,-83.311145,-83.323585299992,-83.311162800005,-83.3081790500468,-83.3177224999804,-83.3035907999999,-83.4797248499892,-83.2596197999931,-83.4797161500398,-83.4095090000182,-83.4078392500302,-83.3203360499991,-83.3196313999938,-83.3192052999968,-83.3165553500185,-83.321466750003,-83.3213422999991,-83.5530911000105,-83.2948176500163,-83.2940356999949,-83.4769919500049,-83.2941582499577,-83.2949069999755,-83.5130761999995,-83.3549776999994,-83.3212903500495,-83.3555997999972,-83.3208899000207,-83.3695943999985,-83.3480147500096,-83.3209295000076,-83.5720037499942,-83.5160472000017,-83.06662205,-83.1132424499971,-83.0188266999967,-83.0663233000209,-83.0188179999562,-83.3525746499696,-83.3519130500019,-83.5280735499695,-83.5278750500122,-83.5276211999899,-83.466128849999,-83.2020124000061,-83.4661491999987,-83.5082221499959,-83.7732507999995,-83.0582092500281,-83.0616972500254],4,null,null,{"interactive":true,"className":"","stroke":true,"color":["blue","orange","blue","blue","red","red","orange","orange","red","blue","orange","orange","orange","blue","orange","blue","blue","red","orange","orange","red","blue","red","orange","red","orange","blue","orange","red","orange","blue","orange","red","red","orange","blue","blue","red","orange","orange","blue","red","orange","orange","red","red","blue","orange","blue","orange","orange","blue","blue","orange","blue","orange","orange","blue","red","orange","red","blue","blue","blue","blue","blue","red","orange","red","blue","red","blue","blue"],"weight":5,"opacity":0.7,"fill":true,"fillColor":["blue","orange","blue","blue","red","red","orange","orange","red","blue","orange","orange","orange","blue","orange","blue","blue","red","orange","orange","red","blue","red","orange","red","orange","blue","orange","red","orange","blue","orange","red","red","orange","blue","blue","red","orange","orange","blue","red","orange","orange","red","red","blue","orange","blue","orange","orange","blue","blue","orange","blue","orange","orange","blue","red","orange","red","blue","blue","blue","blue","blue","red","orange","red","blue","red","blue","blue"],"fillOpacity":0.3},null,null,["Attenborough <br>duration = 2 h <br>npos = 13  Radius = 12.7 m <br>lon = -83.42769 lat = 8.589805","Attenborough <br>duration = 2.5 h <br>npos = 15  Radius = 46.2 m <br>lon = -83.433068 lat = 8.623109","Attenborough <br>duration = 5.2 h <br>npos = 32  Radius = 38.7 m <br>lon = -83.427662 lat = 8.589843","Attenborough <br>duration = 11.8 h <br>npos = 13  Radius = 17.9 m <br>lon = -83.427673 lat = 8.588658","Attenborough <br>duration = 1.7 h <br>npos = 11  Radius = 18.9 m <br>lon = -83.433435 lat = 8.623451","Attenborough <br>duration = 5.3 h <br>npos = 33  Radius = 17.5 m <br>lon = -83.433058 lat = 8.622685","Attenborough <br>duration = 4.7 h <br>npos = 29  Radius = 32.9 m <br>lon = -83.433231 lat = 8.623392","Attenborough <br>duration = 11.7 h <br>npos = 12  Radius = 15.3 m <br>lon = -83.433012 lat = 8.622911","Attenborough <br>duration = 16 h <br>npos = 38  Radius = 33.5 m <br>lon = -83.433382 lat = 8.623358","Carolina <br>duration = 13 h <br>npos = 4  Radius = 31.9 m <br>lon = -83.126606 lat = 8.917675","Carolina <br>duration = 2.3 h <br>npos = 7  Radius = 27.8 m <br>lon = -83.43324 lat = 8.752584","Carolina <br>duration = 2 h <br>npos = 3  Radius = 14 m <br>lon = -83.236314 lat = 8.845713","Carolina <br>duration = 12 h <br>npos = 3  Radius = 43.2 m <br>lon = -83.235791 lat = 8.846807","Charizard <br>duration = 1.7 h <br>npos = 5  Radius = 21.4 m <br>lon = -83.860574 lat = 9.369027","Charizard <br>duration = 2 h <br>npos = 3  Radius = 5.3 m <br>lon = -83.897636 lat = 9.386246","Charizard <br>duration = 4.7 h <br>npos = 15  Radius = 45.7 m <br>lon = -83.860494 lat = 9.36893","Charizard <br>duration = 12 h <br>npos = 3  Radius = 35.2 m <br>lon = -83.857006 lat = 9.366755","Charizard <br>duration = 1.8 h <br>npos = 5  Radius = 22.6 m <br>lon = -83.894857 lat = 9.381324","Charizard <br>duration = 2 h <br>npos = 3  Radius = 38.3 m <br>lon = -83.894745 lat = 9.381521","Charizard <br>duration = 13 h <br>npos = 4  Radius = 12 m <br>lon = -83.898175 lat = 9.385415","Charizard <br>duration = 14 h <br>npos = 5  Radius = 27.2 m <br>lon = -83.89314 lat = 9.378303","Elvis <br>duration = 14 h <br>npos = 5  Radius = 32.5 m <br>lon = -83.318364 lat = 8.416513","Elvis <br>duration = 3 h <br>npos = 4  Radius = 34 m <br>lon = -83.323778 lat = 8.390646","Elvis <br>duration = 14 h <br>npos = 5  Radius = 17.2 m <br>lon = -83.311145 lat = 8.408059","Elvis <br>duration = 16 h <br>npos = 7  Radius = 49.8 m <br>lon = -83.323585 lat = 8.39088","Forsyth <br>duration = 2.3 h <br>npos = 15  Radius = 8.3 m <br>lon = -83.311163 lat = 8.398077","Forsyth <br>duration = 11.5 h <br>npos = 11  Radius = 21.1 m <br>lon = -83.308179 lat = 8.40861","Forsyth <br>duration = 2.3 h <br>npos = 15  Radius = 26.4 m <br>lon = -83.317722 lat = 8.398646","Forsyth <br>duration = 13.5 h <br>npos = 22  Radius = 48.7 m <br>lon = -83.303591 lat = 8.391918","Fossey <br>duration = 1.5 h <br>npos = 10  Radius = 13.8 m <br>lon = -83.479725 lat = 8.999697","Fossey <br>duration = 2.2 h <br>npos = 14  Radius = 9.4 m <br>lon = -83.25962 lat = 8.946599","Fossey <br>duration = 13.7 h <br>npos = 24  Radius = 45.8 m <br>lon = -83.479716 lat = 8.999574","Fossey <br>duration = 1.7 h <br>npos = 11  Radius = 32.8 m <br>lon = -83.409509 lat = 8.967779","Fossey <br>duration = 11.3 h <br>npos = 8  Radius = 18 m <br>lon = -83.407839 lat = 8.980904","Frosty <br>duration = 3 h <br>npos = 4  Radius = 13.1 m <br>lon = -83.320336 lat = 8.519585","Frosty <br>duration = 5 h <br>npos = 6  Radius = 39.2 m <br>lon = -83.319631 lat = 8.519851","Frosty <br>duration = 13 h <br>npos = 4  Radius = 50 m <br>lon = -83.319205 lat = 8.519014","Frosty <br>duration = 4 h <br>npos = 5  Radius = 30.5 m <br>lon = -83.316555 lat = 8.522499","Frosty <br>duration = 3 h <br>npos = 4  Radius = 34.8 m <br>lon = -83.321467 lat = 8.519819","Frosty <br>duration = 12 h <br>npos = 3  Radius = 11.2 m <br>lon = -83.321342 lat = 8.519723","Goodall <br>duration = 1.6 h <br>npos = 10  Radius = 27.5 m <br>lon = -83.553091 lat = 8.512055","Goodall <br>duration = 3.2 h <br>npos = 20  Radius = 18.7 m <br>lon = -83.294818 lat = 8.439472","Goodall <br>duration = 3.2 h <br>npos = 19  Radius = 40.2 m <br>lon = -83.294036 lat = 8.440396","Goodall <br>duration = 14.2 h <br>npos = 18  Radius = 34.9 m <br>lon = -83.476992 lat = 8.454332","Goodall <br>duration = 1.7 h <br>npos = 11  Radius = 21.1 m <br>lon = -83.294158 lat = 8.440478","Goodall <br>duration = 12.8 h <br>npos = 17  Radius = 37.9 m <br>lon = -83.294907 lat = 8.438567","Jatayu <br>duration = 13 h <br>npos = 4  Radius = 11.9 m <br>lon = -83.513076 lat = 8.512498","Messi <br>duration = 2 h <br>npos = 3  Radius = 24.7 m <br>lon = -83.354978 lat = 8.422486","Messi <br>duration = 13 h <br>npos = 4  Radius = 48.1 m <br>lon = -83.32129 lat = 8.472678","Messi <br>duration = 5 h <br>npos = 6  Radius = 46.5 m <br>lon = -83.3556 lat = 8.421832","Moskovits <br>duration = 1.8 h <br>npos = 6  Radius = 29.7 m <br>lon = -83.32089 lat = 8.495376","Moskovits <br>duration = 1.7 h <br>npos = 7  Radius = 34.6 m <br>lon = -83.369594 lat = 8.506878","Moskovits <br>duration = 12 h <br>npos = 3  Radius = 23.1 m <br>lon = -83.348015 lat = 8.52081","Moskovits <br>duration = 14 h <br>npos = 5  Radius = 22.9 m <br>lon = -83.32093 lat = 8.495423","Robin.Hood <br>duration = 13 h <br>npos = 4  Radius = 27 m <br>lon = -83.572004 lat = 8.64715","Robin.Hood <br>duration = 13 h <br>npos = 4  Radius = 7.1 m <br>lon = -83.516047 lat = 8.456622","Rocky <br>duration = 3.8 h <br>npos = 5  Radius = 48.2 m <br>lon = -83.066622 lat = 8.538356","Rocky <br>duration = 3 h <br>npos = 4  Radius = 31.4 m <br>lon = -83.113242 lat = 8.609674","Rocky <br>duration = 3.2 h <br>npos = 6  Radius = 12 m <br>lon = -83.018827 lat = 8.282949","Rocky <br>duration = 15 h <br>npos = 6  Radius = 32.3 m <br>lon = -83.066323 lat = 8.5379","Rocky <br>duration = 4 h <br>npos = 5  Radius = 47.7 m <br>lon = -83.018818 lat = 8.282984","Santa <br>duration = 1.7 h <br>npos = 4  Radius = 46.8 m <br>lon = -83.352575 lat = 8.467097","Santa <br>duration = 11 h <br>npos = 2  Radius = 7.3 m <br>lon = -83.351913 lat = 8.467738","Ugalde <br>duration = 2 h <br>npos = 13  Radius = 30.9 m <br>lon = -83.528074 lat = 9.029118","Ugalde <br>duration = 1.5 h <br>npos = 10  Radius = 46.1 m <br>lon = -83.527875 lat = 9.028829","Ugalde <br>duration = 12.5 h <br>npos = 17  Radius = 22.7 m <br>lon = -83.527621 lat = 9.028437","Ugalde <br>duration = 3 h <br>npos = 19  Radius = 21.1 m <br>lon = -83.466129 lat = 8.586197","Ugalde <br>duration = 14 h <br>npos = 26  Radius = 12.7 m <br>lon = -83.202012 lat = 8.927244","Ugalde <br>duration = 16 h <br>npos = 38  Radius = 29 m <br>lon = -83.466149 lat = 8.586136","Wencelas <br>duration = 13 h <br>npos = 4  Radius = 45.6 m <br>lon = -83.508222 lat = 8.469643","Wencelas <br>duration = 12 h <br>npos = 2  Radius = 2.4 m <br>lon = -83.773251 lat = 9.210312","Wilson <br>duration = 1.5 h <br>npos = 10  Radius = 25.7 m <br>lon = -83.058209 lat = 8.695356","Wilson <br>duration = 12.5 h <br>npos = 17  Radius = 48.8 m <br>lon = -83.061697 lat = 8.699037"],null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":false,"updateWhenIdle":true,"position":"topleft"}]},{"method":"addLayersControl","args":[["OS","Simple","Satellite"],[],{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"addLegend","args":[{"colors":["red","orange","blue"],"labels":["<24","24-48","48+"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"unknown","title":"Cluster age","extra":null,"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[8.2761738,9.3862547],"lng":[-83.8982309,-82.9952245]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="costa-rica-1.html#cb10-1"></a><span class="co"># Also include night&#39;time sleep locations? Would that be useful?</span></span>
<span id="cb10-2"><a href="costa-rica-1.html#cb10-2"></a></span>
<span id="cb10-3"><a href="costa-rica-1.html#cb10-3"></a><span class="co"># Cluster map</span></span>
<span id="cb10-4"><a href="costa-rica-1.html#cb10-4"></a></span>
<span id="cb10-5"><a href="costa-rica-1.html#cb10-5"></a><span class="co"># - Nighttime locations</span></span>
<span id="cb10-6"><a href="costa-rica-1.html#cb10-6"></a><span class="co"># - Last 72 hours - can we colour code --&gt; based on recent locations </span></span>
<span id="cb10-7"><a href="costa-rica-1.html#cb10-7"></a><span class="co"># - Work flow</span></span>
<span id="cb10-8"><a href="costa-rica-1.html#cb10-8"></a><span class="co"># Open cluster tab</span></span>
<span id="cb10-9"><a href="costa-rica-1.html#cb10-9"></a><span class="co"># Identify accessible clusters</span></span>
<span id="cb10-10"><a href="costa-rica-1.html#cb10-10"></a>  <span class="co"># Gps points</span></span>
<span id="cb10-11"><a href="costa-rica-1.html#cb10-11"></a>  <span class="co"># Size of the spread</span></span>
<span id="cb10-12"><a href="costa-rica-1.html#cb10-12"></a><span class="co"># Make sure </span></span>
<span id="cb10-13"><a href="costa-rica-1.html#cb10-13"></a><span class="co"># Cheris look at master protocol --&gt; </span></span></code></pre></div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="cluster-detection.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hardware-function-and-settings.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Osa Conservation: Tracker Checker.pdf", "Osa Conservation: Tracker Checker.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
