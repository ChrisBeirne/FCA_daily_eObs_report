[["index.html", "Test-Bookdown Part 1 Welcome", " Test-Bookdown ChrisB Part 1 Welcome library(move) ## Loading required package: geosphere ## Loading required package: sp ## Loading required package: raster ## Loading required package: rgdal ## Please note that rgdal will be retired by the end of 2023, ## plan transition to sf/stars/terra functions using GDAL and PROJ ## at your earliest convenience. ## ## rgdal: version: 1.5-32, (SVN revision 1176) ## Geospatial Data Abstraction Library extensions to R successfully loaded ## Loaded GDAL runtime: GDAL 3.4.2, released 2022/03/08 ## Path to GDAL shared files: /Users/runner/work/_temp/Library/rgdal/gdal ## GDAL binary built with GEOS: FALSE ## Loaded PROJ runtime: Rel. 8.2.1, January 1st, 2022, [PJ_VERSION: 821] ## Path to PROJ shared files: /Users/runner/work/_temp/Library/rgdal/proj ## PROJ CDN enabled: FALSE ## Linking to sp version:1.5-0 ## To mute warnings of possible GDAL/OSR exportToProj4() degradation, ## use options(&quot;rgdal_show_exportToProj4_warnings&quot;=&quot;none&quot;) before loading sp or rgdal. library(dplyr) ## ## Attaching package: &#39;dplyr&#39; ## The following objects are masked from &#39;package:raster&#39;: ## ## intersect, select, union ## The following objects are masked from &#39;package:stats&#39;: ## ## filter, lag ## The following objects are masked from &#39;package:base&#39;: ## ## intersect, setdiff, setequal, union library(leaflet) library(sf) ## Linking to GEOS 3.10.2, GDAL 3.4.2, PROJ 8.2.1; sf_use_s2() is TRUE library(viridis) ## Loading required package: viridisLite loginStored &lt;- movebankLogin(username=&quot;ChrisBeirne&quot;, password=&quot;EcuadorG11&quot;) # Get animals animals &lt;-getMovebankAnimals(study=1573471517,login=loginStored) # For some reason they are duplicated animals[duplicated(animals)==F,] ## individual_id tag_id sensor_type_id tag_local_identifier deployment_id ## 1 1574170256 1574129610 653 8962 1574170927 ## 2 1574170256 1574129610 2365683 8962 1574170927 ## 3 1574173742 1574129099 653 8961 1574174172 ## 4 1574173742 1574129099 2365683 8961 1574174172 ## 5 1582333209 1574129330 653 8712 1582334185 ## 6 1582333209 1574129330 2365683 8712 1582334185 ## 7 1604972903 1574130199 653 8713 1604973792 ## 8 1604972903 1574130199 2365683 8713 1604973792 ## 9 1618629909 1574130035 653 8714 1618902368 ## 10 1618629909 1574130035 2365683 8714 1618902368 ## 11 1620675994 1620580763 653 0-4640420 1826845362 ## 12 1620676359 1620583484 653 0-4640500 1826850185 ## 13 1620676359 1620583484 7842954 0-4640500 1826850185 ## 14 1665183396 1574129481 653 8963 1666822511 ## 15 1665183396 1574129481 2365683 8963 1666822511 ## 16 1665185357 1644372091 653 8959 1665191187 ## 17 1665185357 1644372091 2365683 8959 1665191187 ## 18 1665185741 1644351741 653 8964 1665191715 ## 19 1665185741 1644351741 2365683 8964 1665191715 ## 20 1932590259 1933592609 653 8720 1976899013 ## 21 1932590259 1933592609 2365683 8720 1976899013 ## 22 1935241656 1933592734 653 8721 1978353719 ## 23 1935241656 1933592734 2365683 8721 1978353719 ## 24 1935242935 1933592681 653 8723 2010835409 ## 25 1935242935 1933592681 2365683 8723 2010835409 ## 26 1935244633 1933592747 653 8719 1956657639 ## 27 1935244633 1933592747 2365683 8719 1956657639 ## 28 1935246288 1933592631 653 8724 1987566233 ## 29 1935246288 1933592631 2365683 8724 1987566233 ## 30 1935247131 1933592708 653 8722 1984290598 ## 31 1935247131 1933592708 2365683 8722 1984290598 ## 32 1935247860 1933592693 653 8725 1988684593 ## 33 1935247860 1933592693 2365683 8725 1988684593 ## comments death_comments earliest_date_born exact_date_of_birth ## 1 NA NA NA NA ## 2 NA NA NA NA ## 3 NA NA NA NA ## 4 NA NA NA NA ## 5 NA NA NA NA ## 6 NA NA NA NA ## 7 NA NA NA NA ## 8 NA NA NA NA ## 9 NA NA NA NA ## 10 NA NA NA NA ## 11 NA NA NA NA ## 12 NA NA NA NA ## 13 NA NA NA NA ## 14 NA NA NA NA ## 15 NA NA NA NA ## 16 NA NA NA NA ## 17 NA NA NA NA ## 18 NA NA NA NA ## 19 NA NA NA NA ## 20 NA NA NA NA ## 21 NA NA NA NA ## 22 NA NA NA NA ## 23 NA NA NA NA ## 24 NA NA NA NA ## 25 NA NA NA NA ## 26 NA NA NA NA ## 27 NA NA NA NA ## 28 NA NA NA NA ## 29 NA NA NA NA ## 30 NA NA NA NA ## 31 NA NA NA NA ## 32 NA NA NA NA ## 33 NA NA NA NA ## latest_date_born local_identifier nick_name ring_id sex ## 1 NA OC6 NA NA ## 2 NA OC6 NA NA ## 3 NA OC8 NA NA ## 4 NA OC8 NA NA ## 5 NA OC3 NA NA ## 6 NA OC3 NA NA ## 7 NA OC4 NA NA u ## 8 NA OC4 NA NA u ## 9 NA OC9 NA NA ## 10 NA OC9 NA NA ## 11 NA OC5 NA NA u ## 12 NA OC7 NA NA u ## 13 NA OC7 NA NA u ## 14 NA OC10 NA NA u ## 15 NA OC10 NA NA u ## 16 NA OC1 NA NA u ## 17 NA OC1 NA NA u ## 18 NA OC2 NA NA u ## 19 NA OC2 NA NA u ## 20 NA Ugalde NA NA ## 21 NA Ugalde NA NA ## 22 NA Forsyth NA NA ## 23 NA Forsyth NA NA ## 24 NA Wilson NA NA ## 25 NA Wilson NA NA ## 26 NA Attenborough NA NA ## 27 NA Attenborough NA NA ## 28 NA Goodall NA NA ## 29 NA Goodall NA NA ## 30 NA Fossey NA NA ## 31 NA Fossey NA NA ## 32 NA Carson NA NA ## 33 NA Carson NA NA ## taxon_canonical_name timestamp_start timestamp_end ## 1 Cathartes melambrotus 2021-06-11 17:00:26.000 2022-02-18 16:00:53.000 ## 2 Cathartes melambrotus 2021-06-11 17:00:26.000 2022-02-18 16:00:53.000 ## 3 Cathartes melambrotus 2021-06-10 17:00:17.000 2022-10-11 16:00:23.000 ## 4 Cathartes melambrotus 2021-06-10 17:00:17.000 2022-10-11 16:00:23.000 ## 5 Sarcoramphus papa 2021-06-19 11:00:53.000 2022-10-11 16:00:19.000 ## 6 Sarcoramphus papa 2021-06-19 11:00:53.000 2022-10-11 16:00:19.000 ## 7 Sarcoramphus papa 2021-07-03 10:01:23.000 2021-08-12 15:00:34.000 ## 8 Sarcoramphus papa 2021-07-03 10:01:23.000 2021-08-12 15:00:34.000 ## 9 Sarcoramphus papa 2021-07-10 10:00:53.000 2022-10-09 14:00:11.000 ## 10 Sarcoramphus papa 2021-07-10 10:00:53.000 2022-10-09 14:00:11.000 ## 11 Sarcoramphus papa 2021-07-05 16:52:00.000 2021-09-17 17:32:00.000 ## 12 Sarcoramphus papa 2021-07-06 17:16:00.000 2022-10-11 17:40:07.000 ## 13 Sarcoramphus papa 2021-07-06 17:16:00.000 2022-10-11 17:40:07.000 ## 14 Cathartes melambrotus 2021-08-09 12:11:36.000 2022-10-11 16:00:25.000 ## 15 Cathartes melambrotus 2021-08-09 12:11:36.000 2022-10-11 16:00:25.000 ## 16 Cathartes melambrotus 2021-08-09 11:01:53.000 2022-10-08 21:00:21.000 ## 17 Cathartes melambrotus 2021-08-09 11:01:53.000 2022-10-08 21:00:21.000 ## 18 Cathartes melambrotus 2021-08-09 00:02:08.000 2022-09-05 16:00:20.000 ## 19 Cathartes melambrotus 2021-08-09 00:02:08.000 2022-09-05 16:00:20.000 ## 20 Sarcoramphus papa 2022-03-02 15:00:53.000 2022-10-11 16:00:19.000 ## 21 Sarcoramphus papa 2022-03-02 15:00:53.000 2022-10-11 16:00:19.000 ## 22 Sarcoramphus papa 2022-03-03 12:31:29.000 2022-10-11 16:00:19.000 ## 23 Sarcoramphus papa 2022-03-03 12:31:29.000 2022-10-11 16:00:19.000 ## 24 Sarcoramphus papa 2022-03-24 20:00:43.000 2022-10-11 16:00:19.000 ## 25 Sarcoramphus papa 2022-03-24 20:00:43.000 2022-10-11 16:00:19.000 ## 26 Sarcoramphus papa 2022-02-16 16:00:41.000 2022-10-11 16:00:12.000 ## 27 Sarcoramphus papa 2022-02-16 16:00:41.000 2022-10-11 16:00:12.000 ## 28 Sarcoramphus papa 2022-03-09 20:30:41.000 2022-10-11 16:00:45.000 ## 29 Sarcoramphus papa 2022-03-09 20:30:41.000 2022-10-11 16:00:45.000 ## 30 Sarcoramphus papa 2022-03-07 16:30:23.000 2022-10-11 16:00:19.000 ## 31 Sarcoramphus papa 2022-03-07 16:30:23.000 2022-10-11 16:00:19.000 ## 32 Sarcoramphus papa 2022-03-10 13:00:47.000 2022-09-09 16:00:53.000 ## 33 Sarcoramphus papa 2022-03-10 13:00:47.000 2022-09-09 16:00:53.000 ## number_of_events number_of_deployments sensor_type_ids ## 1 9075 1 acceleration,gps ## 2 9075 1 acceleration,gps ## 3 21086 1 acceleration,gps ## 4 21086 1 acceleration,gps ## 5 36250 1 acceleration,gps ## 6 36250 1 acceleration,gps ## 7 2462 1 acceleration,gps ## 8 2462 1 acceleration,gps ## 9 34719 1 acceleration,gps ## 10 34719 1 acceleration,gps ## 11 1070 1 gps ## 12 6707 1 accessory-measurements,gps ## 13 6707 1 accessory-measurements,gps ## 14 14246 1 acceleration,gps ## 15 14246 1 acceleration,gps ## 16 12975 1 acceleration,gps ## 17 12975 1 acceleration,gps ## 18 15287 1 acceleration,gps ## 19 15287 1 acceleration,gps ## 20 20271 1 acceleration,gps ## 21 20271 1 acceleration,gps ## 22 18499 1 acceleration,gps ## 23 18499 1 acceleration,gps ## 24 15878 1 acceleration,gps ## 25 15878 1 acceleration,gps ## 26 24167 1 acceleration,gps ## 27 24167 1 acceleration,gps ## 28 17338 1 acceleration,gps ## 29 17338 1 acceleration,gps ## 30 17641 1 acceleration,gps ## 31 17641 1 acceleration,gps ## 32 12593 1 acceleration,gps ## 33 12593 1 acceleration,gps ## taxon_detail animalName ## 1 NA OC6_1574170927 ## 2 NA OC6_1574170927 ## 3 NA OC8_1574174172 ## 4 NA OC8_1574174172 ## 5 NA OC3_1582334185 ## 6 NA OC3_1582334185 ## 7 NA OC4_1604973792 ## 8 NA OC4_1604973792 ## 9 NA OC9_1618902368 ## 10 NA OC9_1618902368 ## 11 NA OC5_1826845362 ## 12 NA OC7_1826850185 ## 13 NA OC7_1826850185 ## 14 NA OC10_1666822511 ## 15 NA OC10_1666822511 ## 16 NA OC1_1665191187 ## 17 NA OC1_1665191187 ## 18 NA OC2_1665191715 ## 19 NA OC2_1665191715 ## 20 NA Ugalde_1976899013 ## 21 NA Ugalde_1976899013 ## 22 NA Forsyth_1978353719 ## 23 NA Forsyth_1978353719 ## 24 NA Wilson_2010835409 ## 25 NA Wilson_2010835409 ## 26 NA Attenborough_1956657639 ## 27 NA Attenborough_1956657639 ## 28 NA Goodall_1987566233 ## 29 NA Goodall_1987566233 ## 30 NA Fossey_1984290598 ## 31 NA Fossey_1984290598 ## 32 NA Carson_1988684593 ## 33 NA Carson_1988684593 # They vary by the field &quot;sensor_type_id&quot; animals &lt;- animals[animals$sensor_type_id==653,] # Get last 2 weeks t &lt;- strptime(Sys.time(),format=&quot;%Y-%m-%d %H:%M:%S&quot;, tz=&#39;UTC&#39;) dat &lt;- getMovebankData(study=1573471517, login=loginStored, removeDuplicatedTimestamps=TRUE, timestamp_start=t-as.difftime(14,units=&#39;days&#39;), timestamp_end=t) ## removeDupilcatedTimestamps was set to TRUE, this will retain the first of multiple records with the same animal ID and timestamp, and remove any subsequent duplicates ## Warning in .local(study, animalName, login, ...): 60 location(s) is/are removed ## by removeDuplicatedTimestamps # Convery move stack to dataframe dat &lt;- as.data.frame(dat) dat &lt;- left_join(dat, animals[, c(&quot;tag_id&quot;, &quot;animalName&quot;)]) ## Joining, by = &quot;tag_id&quot; # Sort the names out dat$animalName &lt;- sub(&#39;\\\\_.*&#39;, &#39;&#39;, dat$animalName) # Add in the taxonomic group dat$animalName &lt;- paste0(dat$animalName, &quot;_&quot;, sub(&#39;\\\\ .*&#39;, &#39;&#39;, dat$taxon_canonical_name)) # Add a country column dat$country &lt;- dat$location_lat&lt;0 dat$country[dat$country==T] &lt;- &quot;peru&quot; dat$country[dat$country==F] &lt;- &quot;costa_rica&quot; #table(dat$country) # Costa rica # Convert to shapefiles dat &lt;- dat[order(dat$animalName),] lfc &lt;- do.call(st_sfc, lapply(split(dat, dat$animalName), function(d){st_linestring(as.matrix(d[,c(&quot;location_long&quot;, &quot;location_lat&quot;)]))})) dat_shp &lt;- st_sf(data.frame(animalName=levels(factor(dat[,&quot;animalName&quot;])), geom=lfc)) # #plot(dat$location_long[dat$country==&quot;costa_rica&quot;], dat$location_lat[dat$country==&quot;costa_rica&quot;]) #plot(st_geometry(dat_shp), add=T) sp_dat &lt;- dat[,c(&quot;animalName&quot;, &quot;country&quot;, &quot;taxon_canonical_name&quot; )] sp_dat &lt;- sp_dat[duplicated(sp_dat)==F,] # add back in the metadata dat_shp &lt;- left_join(dat_shp,sp_dat) ## Joining, by = &quot;animalName&quot; tmp &lt;- dat[dat$country==&quot;costa_rica&quot;,] tmp_shp &lt;- dat_shp[dat_shp$country==&quot;costa_rica&quot;,] # First lets choose a category to colour tmp[,&quot;animalName&quot;] &lt;- factor(tmp[,&quot;animalName&quot;]) tmp_shp$animalName &lt;- factor(tmp_shp$animalName) col.cat &lt;- turbo(length(levels(tmp[,&quot;animalName&quot;]))) # Add it to the dataframe tmp$colours &lt;- col.cat[tmp[,&quot;animalName&quot;]] tmp_shp$colours &lt;- col.cat[tmp_shp$animalName] m &lt;- leaflet() %&gt;% # Add a satellite image layer addProviderTiles(providers$Stamen.TonerLite, group=&quot;Simple&quot;) %&gt;% addProviderTiles(providers$Esri.WorldImagery, group=&quot;Satellite&quot;) %&gt;% addProviderTiles(providers$Esri.WorldTopoMap, group=&quot;OS&quot;) %&gt;% addCircleMarkers(lng=tmp$location_long, lat=tmp$location_lat, # Colour the markers depending on the &#39;feature type&#39; color=tmp$colours, radius=3, stroke=F, # Add a popup of the deployment code popup=paste(tmp$animalName, tmp$timestamp)) %&gt;% addPolylines(data=dat_shp, color = tmp_shp$colours, weight = 1, smoothFactor = 0.5, opacity = 1.0, fillOpacity = 0.5) %&gt;% # Add a legend explaining what is going on addLegend(&quot;bottomright&quot;, colors = col.cat, labels = levels(tmp[,&quot;animalName&quot;]), title = &quot;Name&quot;, labFormat = labelFormat(prefix = &quot;$&quot;), opacity = 1 ) %&gt;% # add a layer control box to toggle between the layers addLayersControl( baseGroups = c(&quot;Simple&quot;, &quot;Satellite&quot;, &quot;OS&quot;), options = layersControlOptions(collapsed = FALSE) ) m "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
